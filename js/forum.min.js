/*! For license information please see forum.min.js.LICENSE.txt */
!function(){"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=i>>2,h=(3&i)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(l=64)),r.push(n[u],n[h],n[l],n[d])}return r.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==c)throw new r;const u=s<<2|o>>4;if(i.push(u),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==c){const t=a<<6&192|c;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class r extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i=function(t){return function(t){const r=e(t);return n.encodeByteArray(r,!0)}(t).replace(/\./g,"")},s=function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&s(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},a=t=>{var e,n;return null===(n=null===(e=o())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},c=t=>{const e=a(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},u=()=>{var t;return null===(t=o())||void 0===t?void 0:t.config},h=t=>{var e;return null===(e=o())||void 0===e?void 0:e[`_${t}`]};class l{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(o)),""].join(".")}function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){try{return"object"==typeof indexedDB}catch(t){return!1}}class g extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(y,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new g(r,o,n)}}const y=/\{\$([^}]+)}/g;function v(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(w(n)&&w(s)){if(!v(n,s))return!1}else if(n!==s)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function w(t){return null!==t&&"object"==typeof t}function _(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function E(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,r]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(r)}})),e}function b(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class I{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let r;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=T),void 0===r.error&&(r.error=T),void 0===r.complete&&(r.complete=T);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(t){}})),this.observers.push(r),i}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function S(t){return t&&t._delegate?t._delegate:t}class C{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const A="[DEFAULT]";class k{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new l;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:A})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=A){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=A){return this.instances.has(t)}getOptions(t=A){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===A?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=A){return this.component?this.component.multipleInstances?t:A:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class N{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new k(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const R=[];var O;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(O||(O={}));const D={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},P=O.INFO,L={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},x=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=L[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class M{constructor(t){this.name=t,this._logLevel=P,this._logHandler=x,this._userLogHandler=null,R.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in O))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?D[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...t),this._logHandler(this,O.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...t),this._logHandler(this,O.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,O.INFO,...t),this._logHandler(this,O.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,O.WARN,...t),this._logHandler(this,O.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...t),this._logHandler(this,O.ERROR,...t)}}const U=(t,e)=>e.some((e=>t instanceof e));let F,V;const j=new WeakMap,B=new WeakMap,$=new WeakMap,H=new WeakMap,z=new WeakMap;let q={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return B.get(t);if("objectStoreNames"===e)return t.objectStoreNames||$.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t}};function G(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(V||(V=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(W(this),t),K(j.get(this))}:function(...t){return K(e.apply(W(this),t))}:function(t,...n){const r=e.call(W(this),t,...n);return $.set(r,t.sort?t.sort():[t]),K(r)}:(t instanceof IDBTransaction&&function(t){if(B.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));B.set(t,e)}(t),U(t,F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,q):t);var e}function K(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(K(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&j.set(e,t)})).catch((()=>{})),z.set(e,t),e}(t);if(H.has(t))return H.get(t);const e=G(t);return e!==t&&(H.set(t,e),z.set(e,t)),e}const W=t=>z.get(t),Q=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],J=new Map;function Y(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(J.get(e))return J.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=X.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Q.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return J.set(e,s),s}var Z;Z=q,q={...Z,get:(t,e,n)=>Y(t,e)||Z.get(t,e,n),has:(t,e)=>!!Y(t,e)||Z.has(t,e)};class tt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const et="@firebase/app",nt="0.9.27",rt=new M("@firebase/app"),it="[DEFAULT]",st={[et]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ot=new Map,at=new Map;function ct(t,e){try{t.container.addComponent(e)}catch(n){rt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ut(t){const e=t.name;if(at.has(e))return rt.debug(`There were multiple attempts to register component ${e}.`),!1;at.set(e,t);for(const e of ot.values())ct(e,t);return!0}function ht(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const lt=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class dt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new C("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw lt.create("app-deleted",{appName:this._name})}}const ft="10.8.0";function pt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:it,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw lt.create("bad-app-name",{appName:String(i)});if(n||(n=u()),!n)throw lt.create("no-options");const s=ot.get(i);if(s){if(v(n,s.options)&&v(r,s.config))return s;throw lt.create("duplicate-app",{appName:i})}const o=new N(i);for(const t of at.values())o.addComponent(t);const a=new dt(n,r,o);return ot.set(i,a),a}function gt(t=it){const e=ot.get(t);if(!e&&t===it&&u())return pt();if(!e)throw lt.create("no-app",{appName:t});return e}function mt(t,e,n){var r;let i=null!==(r=st[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void rt.warn(t.join(" "))}ut(new C(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const yt="firebase-heartbeat-database",vt=1,wt="firebase-heartbeat-store";let _t=null;function Et(){return _t||(_t=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=K(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(K(o.result),t.oldVersion,t.newVersion,K(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(yt,vt,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(wt)}catch(t){console.warn(t)}}}).catch((t=>{throw lt.create("idb-open",{originalErrorMessage:t.message})}))),_t}async function bt(t,e){try{const n=(await Et()).transaction(wt,"readwrite"),r=n.objectStore(wt);await r.put(e,It(t)),await n.done}catch(t){if(t instanceof g)rt.warn(t.message);else{const e=lt.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});rt.warn(e.message)}}}function It(t){return`${t.name}!${t.options.appId}`}class Tt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ct(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=St();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=St(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),At(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),At(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=i(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function St(){return(new Date).toISOString().substring(0,10)}class Ct{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!p()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Et()).transaction(wt),n=await e.objectStore(wt).get(It(t));return await e.done,n}catch(t){if(t instanceof g)rt.warn(t.message);else{const e=lt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});rt.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return bt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return bt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function At(t){return i(JSON.stringify({version:2,heartbeats:t})).length}function kt(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}ut(new C("platform-logger",(t=>new tt(t)),"PRIVATE")),ut(new C("heartbeat",(t=>new Tt(t)),"PRIVATE")),mt(et,nt,""),mt(et,nt,"esm2017"),mt("fire-js",""),mt("firebase","10.8.0","app"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Nt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Rt=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ot=new M("@firebase/auth");function Dt(t,...e){Ot.logLevel<=O.ERROR&&Ot.error(`Auth (${ft}): ${t}`,...e)}function Pt(t,...e){throw xt(t,...e)}function Lt(t,...e){return xt(t,...e)}function xt(t,...e){if("string"!=typeof t){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Rt.create(t,...e)}function Mt(t,e,...n){if(!t)throw xt(e,...n)}function Ut(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dt(e),new Error(e)}function Ft(t,e){t||Ut(e)}function Vt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function jt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function Bt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===jt()||"https:"===jt()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class $t{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ft(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Bt()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ht(t,e){Ft(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class zt{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Gt=new $t(3e4,6e4);function Kt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Wt(t,e,n,r,i={}){return Qt(t,i,(async()=>{let i={},s={};r&&("GET"===e?s=r:i={body:JSON.stringify(r)});const o=_(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),zt.fetch()(Jt(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Qt(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},qt),e);try{const e=new Zt(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw te(t,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const e=i.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw te(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw te(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw te(t,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const r=Object.assign(Object.assign({},Nt()),{[e]:n});return new m("auth","Firebase",r).create(e,{appName:t.name})}(t,a,o);Pt(t,a)}}catch(e){if(e instanceof g)throw e;Pt(t,"network-request-failed",{message:String(e)})}}async function Xt(t,e,n,r,i={}){const s=await Wt(t,e,n,r,i);return"mfaPendingCredential"in s&&Pt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Jt(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Ht(t.config,i):`${t.config.apiScheme}://${i}`}function Yt(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Zt{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Lt(this.auth,"network-request-failed"))),Gt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function te(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Lt(t,e,r);return i.customData._tokenResponse=n,i}function ee(t){return void 0!==t&&void 0!==t.enterprise}class ne{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return Yt(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function re(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function ie(t){return 1e3*Number(t)}function se(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return Dt("JWT malformed, contained fewer than 3 sections"),null;try{const t=s(n);return t?JSON.parse(t):(Dt("Failed to decode base64 JWT payload"),null)}catch(t){return Dt("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function oe(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class ae{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class ce{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=re(this.lastLoginAt),this.creationTime=re(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ue(t){var e;const n=t.auth,r=await t.getIdToken(),i=await oe(t,async function(t,e){return Wt(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:r}));Mt(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=kt(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,u=o,[...c.filter((t=>!u.some((e=>e.providerId===t.providerId)))),...u]);var c,u;const h=t.isAnonymous,l=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!h&&l,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ce(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class he{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Mt(t.idToken,"internal-error"),Mt(void 0!==t.idToken,"internal-error"),Mt(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=se(t);return Mt(e,"internal-error"),Mt(void 0!==e.exp,"internal-error"),Mt(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Mt(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(t,e){const n=await Qt(t,{},(async()=>{const n=_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,s=Jt(t,r,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",zt.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:r,expirationTime:i}=e,s=new he;return n&&(Mt("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),r&&(Mt("string"==typeof r,"internal-error",{appName:t}),s.accessToken=r),i&&(Mt("number"==typeof i,"internal-error",{appName:t}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new he,this.toJSON())}_performRefresh(){return Ut("not implemented")}}function le(t,e){Mt("string"==typeof t||void 0===t,"internal-error",{appName:e})}class de{constructor(t){var{uid:e,auth:n,stsTokenManager:r}=t,i=kt(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ae(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ce(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await oe(this,this.stsTokenManager.getToken(this.auth,t));return Mt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=S(t),r=await n.getIdToken(e),i=se(r);Mt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:re(ie(i.auth_time)),issuedAtTime:re(ie(i.iat)),expirationTime:re(ie(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=S(t);await ue(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Mt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new de(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Mt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await ue(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await oe(this,async function(t,e){return Wt(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,r,i,s,o,a,c,u;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(r=e.email)&&void 0!==r?r:void 0,d=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:_,providerData:E,stsTokenManager:b}=e;Mt(v&&b,t,"internal-error");const I=he.fromJSON(this.name,b);Mt("string"==typeof v,t,"internal-error"),le(h,t.name),le(l,t.name),Mt("boolean"==typeof w,t,"internal-error"),Mt("boolean"==typeof _,t,"internal-error"),le(d,t.name),le(f,t.name),le(p,t.name),le(g,t.name),le(m,t.name),le(y,t.name);const T=new de({uid:v,auth:t,email:l,emailVerified:w,displayName:h,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(T.providerData=E.map((t=>Object.assign({},t)))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(t,e,n=!1){const r=new he;r.updateFromServerResponse(e);const i=new de({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:n});return await ue(i),i}}const fe=new Map;function pe(t){Ft(t instanceof Function,"Expected a class definition");let e=fe.get(t);return e?(Ft(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,fe.set(t,e),e)}class ge{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}ge.type="NONE";const me=ge;function ye(t,e,n){return`firebase:${t}:${e}:${n}`}class ve{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ye(this.userKey,r.apiKey,i),this.fullPersistenceKey=ye("persistence",r.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?de._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new ve(pe(me),t,n);const r=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let i=r[0]||pe(me);const s=ye(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const r=de._fromJSON(t,e);n!==i&&(o=r),i=n;break}}catch(t){}const a=r.filter((t=>t._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==i)try{await t._remove(s)}catch(t){}}))),new ve(i,t,n)):new ve(i,t,n)}}function we(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ie(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_e(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Se(e))return"Blackberry";if(Ce(e))return"Webos";if(Ee(e))return"Safari";if((e.includes("chrome/")||be(e))&&!e.includes("edge/"))return"Chrome";if(Te(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function _e(t=f()){return/firefox\//i.test(t)}function Ee(t=f()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function be(t=f()){return/crios\//i.test(t)}function Ie(t=f()){return/iemobile/i.test(t)}function Te(t=f()){return/android/i.test(t)}function Se(t=f()){return/blackberry/i.test(t)}function Ce(t=f()){return/webos/i.test(t)}function Ae(t=f()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ke(t=f()){return Ae(t)||Te(t)||Ce(t)||Se(t)||/windows phone/i.test(t)||Ie(t)}function Ne(t,e=[]){let n;switch(t){case"Browser":n=we(f());break;case"Worker":n=`${we(f())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ft}/${r}`}class Re{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,r)=>{try{n(t(e))}catch(t){r(t)}}));n.onAbort=e,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Oe{constructor(t){var e,n,r,i;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=t.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),r&&(e.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let r=0;r<t.length;r++)n=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=i))}}class De{constructor(t,e,n,r){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Le(this),this.idTokenSubscription=new Le(this),this.beforeStateQueue=new Re(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Rt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=pe(e)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await ve.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(t){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Mt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await ue(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?S(t):null;return e&&Mt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Mt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(pe(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Wt(t,"GET","/v2/passwordPolicy",Kt(t,e))}(this),e=new Oe(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new m("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Wt(t,"POST","/v2/accounts:revokeToken",Kt(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&pe(t)||this._popupRedirectResolver;Mt(e,this,"argument-error"),this.redirectPersistenceManager=await ve.create(this,[pe(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,r){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Mt(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof e){const i=t.addObserver(e,n,r);return()=>{s=!0,i()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Mt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ne(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Ot.logLevel<=O.WARN&&Ot.warn(`Auth (${ft}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Pe(t){return S(t)}class Le{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new I(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Mt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xe={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Me(t){return xe.loadJS(t)}function Ue(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Fe{constructor(t){this.type="recaptcha-enterprise",this.auth=Pe(t)}async verify(t="verify",e=!1){function n(e,n,r){const i=window.grecaptcha;ee(i)?i.enterprise.ready((()=>{i.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,r)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Wt(t,"GET","/v2/recaptchaConfig",Kt(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new ne(r);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((i=>{if(!e&&ee(window.grecaptcha))n(i,t,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let e=xe.recaptchaEnterpriseScript;0!==e.length&&(e+=i),Me(e).then((()=>{n(i,t,r)})).catch((t=>{r(t)}))}})).catch((t=>{r(t)}))}))}}async function Ve(t,e,n,r=!1){const i=new Fe(t);let s;try{s=await i.verify(n)}catch(t){s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function je(t,e,n,r){var i;if(null===(i=t._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ve(t,e,n,"getOobCode"===n);return r(t,i)}return r(t,e).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Ve(t,e,n,"getOobCode"===n);return r(t,i)}return Promise.reject(i)}))}function Be(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $e(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class He{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Ut("not implemented")}_getIdTokenResponse(t){return Ut("not implemented")}_linkToIdToken(t,e){return Ut("not implemented")}_getReauthenticationResolver(t){return Ut("not implemented")}}async function ze(t,e){return Wt(t,"POST","/v1/accounts:signUp",e)}async function qe(t,e){return Xt(t,"POST","/v1/accounts:signInWithPassword",Kt(t,e))}class Ge extends He{constructor(t,e,n,r=null){super("password",n),this._email=t,this._password=e,this._tenantId=r}static _fromEmailAndPassword(t,e){return new Ge(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Ge(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return je(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",qe);case"emailLink":return async function(t,e){return Xt(t,"POST","/v1/accounts:signInWithEmailLink",Kt(t,e))}(t,{email:this._email,oobCode:this._password});default:Pt(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return je(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ze);case"emailLink":return async function(t,e){return Xt(t,"POST","/v1/accounts:signInWithEmailLink",Kt(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Pt(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Ke(t,e){return Xt(t,"POST","/v1/accounts:signInWithIdp",Kt(t,e))}class We extends He{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new We(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Pt("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:r}=e,i=kt(e,["providerId","signInMethod"]);if(!n||!r)return null;const s=new We(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(t){return Ke(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Ke(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ke(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=_(e)}return t}}const Qe={USER_NOT_FOUND:"user-not-found"};class Xe extends He{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Xe({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Xe({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Xt(t,"POST","/v1/accounts:signInWithPhoneNumber",Kt(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Xt(t,"POST","/v1/accounts:signInWithPhoneNumber",Kt(t,e));if(n.temporaryProof)throw te(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Xt(t,"POST","/v1/accounts:signInWithPhoneNumber",Kt(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Qe)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:r}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:r}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}=t;return n||e||r||i?new Xe({verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Je{constructor(t){var e,n,r,i,s,o;const a=E(b(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Mt(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=E(b(t)).link,n=e?E(b(e)).deep_link_id:null,r=E(b(t)).deep_link_id;return(r?E(b(r)).link:null)||r||n||e||t}(t);try{return new Je(e)}catch(t){return null}}}class Ye{constructor(){this.providerId=Ye.PROVIDER_ID}static credential(t,e){return Ge._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Je.parseLink(e);return Mt(n,"argument-error"),Ge._fromEmailAndCode(t,n.code,n.tenantId)}}Ye.PROVIDER_ID="password",Ye.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ye.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ze{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class tn extends Ze{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class en extends tn{constructor(){super("facebook.com")}static credential(t){return We._fromParams({providerId:en.PROVIDER_ID,signInMethod:en.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return en.credentialFromTaggedObject(t)}static credentialFromError(t){return en.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return en.credential(t.oauthAccessToken)}catch(t){return null}}}en.FACEBOOK_SIGN_IN_METHOD="facebook.com",en.PROVIDER_ID="facebook.com";class nn extends tn{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return We._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return nn.credentialFromTaggedObject(t)}static credentialFromError(t){return nn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return nn.credential(e,n)}catch(t){return null}}}nn.GOOGLE_SIGN_IN_METHOD="google.com",nn.PROVIDER_ID="google.com";class rn extends tn{constructor(){super("github.com")}static credential(t){return We._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return rn.credentialFromTaggedObject(t)}static credentialFromError(t){return rn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return rn.credential(t.oauthAccessToken)}catch(t){return null}}}rn.GITHUB_SIGN_IN_METHOD="github.com",rn.PROVIDER_ID="github.com";class sn extends tn{constructor(){super("twitter.com")}static credential(t,e){return We._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return sn.credentialFromTaggedObject(t)}static credentialFromError(t){return sn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return sn.credential(e,n)}catch(t){return null}}}sn.TWITTER_SIGN_IN_METHOD="twitter.com",sn.PROVIDER_ID="twitter.com";class on{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,r=!1){const i=await de._fromIdTokenResponse(t,n,r),s=an(n);return new on({user:i,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const r=an(n);return new on({user:t,providerId:r,_tokenResponse:n,operationType:e})}}function an(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class cn extends g{constructor(t,e,n,r){var i;super(e.code,e.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,cn.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,r){return new cn(t,e,n,r)}}function un(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw cn._fromErrorAndOperation(t,n,e,r);throw n}))}new WeakMap;const hn="__sak";class ln{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(hn,"1"),this.storage.removeItem(hn),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class dn extends ln{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=f();return Ee(t)||Ae(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=ke(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),r=this.localCache[e];n!==r&&t(e,r,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(t.newValue!==r)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},i=this.storage.getItem(n);!function(){const t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||i===t.newValue||t.newValue===t.oldValue?r():setTimeout(r,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}dn.type="LOCAL";const fn=dn;class pn extends ln{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}pn.type="SESSION";const gn=pn;class mn{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new mn(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:r,data:i}=e.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async t=>t(e.origin,i))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function yn(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}mn.receivers=[];class vn{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=yn("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(e.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function wn(){return window}function _n(){return void 0!==wn().WorkerGlobalScope&&"function"==typeof wn().importScripts}const En="firebaseLocalStorageDb",bn="firebaseLocalStorage",In="fbase_key";class Tn{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Sn(t,e){return t.transaction([bn],e?"readwrite":"readonly").objectStore(bn)}function Cn(){const t=indexedDB.open(En,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(bn,{keyPath:In})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(bn)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(En);return new Tn(t).toPromise()}(),e(await Cn()))}))}))}async function An(t,e,n){const r=Sn(t,!0).put({[In]:e,value:n});return new Tn(r).toPromise()}function kn(t,e){const n=Sn(t,!0).delete(e);return new Tn(n).toPromise()}class Nn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Cn()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _n()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mn._getInstance(_n()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new vn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Cn();return await An(t,hn,"1"),await kn(t,hn),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>An(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Sn(t,!1).get(e),r=await new Tn(n).toPromise();return void 0===r?null:r.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>kn(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Sn(t,!1).getAll();return new Tn(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:r,value:i}of t)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),e.push(r));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Nn.type="LOCAL";const Rn=Nn;Ue("rcb"),new $t(3e4,6e4);class On{constructor(t){this.providerId=On.PROVIDER_ID,this.auth=Pe(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var r;const i=await n.verify();try{let s;if(Mt("string"==typeof i,t,"argument-error"),Mt("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Mt("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Wt(t,"POST","/v2/accounts/mfaEnrollment:start",Kt(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Mt("signin"===e.type,t,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Mt(n,t,"missing-multi-factor-info");const o=await function(t,e){return Wt(t,"POST","/v2/accounts/mfaSignIn:start",Kt(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Wt(t,"POST","/v1/accounts:sendVerificationCode",Kt(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return e}}finally{n._reset()}}(this.auth,t,S(e))}static credential(t,e){return Xe._fromVerification(t,e)}static credentialFromResult(t){const e=t;return On.credentialFromTaggedObject(e)}static credentialFromError(t){return On.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Xe._fromTokenResponse(e,n):null}}On.PROVIDER_ID="phone",On.PHONE_SIGN_IN_METHOD="phone";class Dn extends He{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ke(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ke(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ke(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Pn(t){return async function(t,e,n=!1){const r="signIn",i=await un(t,r,e),s=await on._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Dn(t),t.bypassAuthState)}function Ln(t){const{auth:e,user:n}=t;return Mt(n,e,"internal-error"),async function(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await oe(t,un(r,i,e,t),n);Mt(s.idToken,r,"internal-error");const o=se(s.idToken);Mt(o,r,"internal-error");const{sub:a}=o;return Mt(t.uid===a,r,"user-mismatch"),on._forOperation(t,i,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Pt(r,"user-mismatch"),t}}(n,new Dn(t),t.bypassAuthState)}async function xn(t){const{auth:e,user:n}=t;return Mt(n,e,"internal-error"),async function(t,e,n=!1){const r=await oe(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return on._forOperation(t,"link",r)}(n,new Dn(t),t.bypassAuthState)}class Mn{constructor(t,e,n,r,i=!1){this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Pn;case"linkViaPopup":case"linkViaRedirect":return xn;case"reauthViaPopup":case"reauthViaRedirect":return Ln;default:Pt(this.auth,"internal-error")}}resolve(t){Ft(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ft(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Un=new $t(2e3,1e4);class Fn extends Mn{constructor(t,e,n,r,i){super(t,e,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Fn.currentPopupAction&&Fn.currentPopupAction.cancel(),Fn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Mt(t,this.auth,"internal-error"),t}async onExecution(){Ft(1===this.filter.length,"Popup operations only handle one event");const t=yn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Lt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Lt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fn.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Lt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Un.get())};t()}}Fn.currentPopupAction=null;const Vn="pendingRedirect",jn=new Map;class Bn extends Mn{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=jn.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return ye(Vn,t.config.apiKey,t.name)}(e),r=function(t){return pe(t._redirectPersistence)}(t);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}jn.set(this.auth._key(),t)}return this.bypassAuthState||jn.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function $n(t,e){jn.set(t._key(),e)}async function Hn(t,e,n=!1){const r=Pe(t),i=function(t,e){return e?pe(e):(Mt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(r,e),s=new Bn(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}class zn{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gn(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Gn(t)){const r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Lt(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(qn(t))}saveEventToCache(t){this.cachedEventUids.add(qn(t)),this.lastProcessedEventTime=Date.now()}}function qn(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Gn({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Kn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wn=/^https?/;function Qn(t){const e=Vt(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return""===i.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Wn.test(n))return!1;if(Kn.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Xn=new $t(3e4,6e4);function Jn(){const t=wn().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function Yn(t){return new Promise(((e,n)=>{var r,i,s;function o(){Jn(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jn(),n(Lt(t,"network-request-failed"))},timeout:Xn.get()})}if(null===(i=null===(r=wn().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=wn().gapi)||void 0===s?void 0:s.load)){const e=Ue("iframefcb");return wn()[e]=()=>{gapi.load?o():n(Lt(t,"network-request-failed"))},Me(`${xe.gapiScript}?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw Zn=null,t}))}let Zn=null;const tr=new $t(5e3,15e3),er="__/auth/iframe",nr="emulator/auth/iframe",rr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ir=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sr(t){const e=t.config;Mt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ht(e,nr):`https://${t.config.authDomain}/${er}`,r={apiKey:e.apiKey,appName:t.name,v:ft},i=ir.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${_(r).slice(1)}`}const or={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ar{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const cr=encodeURIComponent("fac");async function ur(t,e,n,r,i,s){Mt(t.config.authDomain,t,"auth-domain-config-required"),Mt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ft,eventId:i};if(e instanceof Ze){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof tn){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),u=c?`#${cr}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?Ht(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${_(a).slice(1)}${u}`}const hr="webStorageSupport",lr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gn,this._completeRedirectFn=Hn,this._overrideRedirectResult=$n}async _openPopup(t,e,n,r){var i;return Ft(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(t,e,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},or),{width:r.toString(),height:i.toString(),top:s,left:o}),u=f().toLowerCase();n&&(a=be(u)?"_blank":n),_e(u)&&(e=e||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=f()){var e;return Ae(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",a),new ar(null);const l=window.open(e||"",a,h);Mt(l,t,"popup-blocked");try{l.focus()}catch(t){}return new ar(l)}(t,await ur(t,e,n,Vt(),r),yn())}async _openRedirect(t,e,n,r){return await this._originValidation(t),i=await ur(t,e,n,Vt(),r),wn().location.href=i,new Promise((()=>{}));var i}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Ft(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return Zn=Zn||Yn(t),Zn}(t),n=wn().gapi;return Mt(n,t,"internal-error"),e.open({where:document.body,url:sr(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rr,dontclear:!0},(e=>new Promise((async(n,r)=>{await e.restyle({setHideOnLeave:!1});const i=Lt(t,"network-request-failed"),s=wn().setTimeout((()=>{r(i)}),tr.get());function o(){wn().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{r(i)}))}))))}(t),n=new zn(t);return e.register("authEvent",(e=>(Mt(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(hr,{type:hr},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[hr];void 0!==i&&e(!!i),Pt(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Wt(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Qn(t))return}catch(t){}Pt(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return ke()||Ee()||Ae()}};var dr="@firebase/auth",fr="1.6.0";class pr{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Mt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const gr=h("authIdTokenMaxAge")||300;let mr=null;var yr;!function(t){xe=t}({loadJS(t){return new Promise(((e,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",t),r.onload=e,r.onerror=t=>{const e=Lt("internal-error");e.customData=t,n(e)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}))},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),yr="Browser",ut(new C("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),i=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Mt(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:yr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ne(yr)},c=new De(n,r,i,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pe);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),ut(new C("auth-internal",(t=>{return e=Pe(t.getProvider("auth").getImmediate()),new pr(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),mt(dr,fr,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(yr)),mt(dr,fr,"esm2017");var vr,wr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_r={},Er=Er||{},br=wr||self;function Ir(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Tr(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Sr="closure_uid_"+(1e9*Math.random()>>>0),Cr=0;function Ar(t,e,n){return t.call.apply(t.bind,arguments)}function kr(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Nr(t,e,n){return(Nr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ar:kr).apply(null,arguments)}function Rr(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Or(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function Dr(){this.s=this.s,this.o=this.o}Dr.prototype.s=!1,Dr.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Sr)&&t[Sr]||(t[Sr]=++Cr))},Dr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Pr=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Lr(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function xr(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Ir(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let i=0;i<r;i++)t[e+i]=n[i]}else t.push(n)}}function Mr(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Mr.prototype.h=function(){this.defaultPrevented=!0};var Ur=function(){if(!br.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};br.addEventListener("test",t,e),br.removeEventListener("test",t,e)}catch(t){}return t}();function Fr(t){return/^[\s\xa0]*$/.test(t)}function Vr(){var t=br.navigator;return t&&(t=t.userAgent)?t:""}function jr(t){return-1!=Vr().indexOf(t)}function Br(t){return Br[" "](t),t}Br[" "]=function(){};var $r,Hr,zr,qr=jr("Opera"),Gr=jr("Trident")||jr("MSIE"),Kr=jr("Edge"),Wr=Kr||Gr,Qr=jr("Gecko")&&!(-1!=Vr().toLowerCase().indexOf("webkit")&&!jr("Edge"))&&!(jr("Trident")||jr("MSIE"))&&!jr("Edge"),Xr=-1!=Vr().toLowerCase().indexOf("webkit")&&!jr("Edge");function Jr(){var t=br.document;return t?t.documentMode:void 0}t:{var Yr="",Zr=(Hr=Vr(),Qr?/rv:([^\);]+)(\)|;)/.exec(Hr):Kr?/Edge\/([\d\.]+)/.exec(Hr):Gr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Hr):Xr?/WebKit\/(\S+)/.exec(Hr):qr?/(?:Version)[ \/]?(\S+)/.exec(Hr):void 0);if(Zr&&(Yr=Zr?Zr[1]:""),Gr){var ti=Jr();if(null!=ti&&ti>parseFloat(Yr)){$r=String(ti);break t}}$r=Yr}br.document&&Gr?zr=Jr()||parseInt($r,10)||void 0:zr=void 0;var ei=zr;function ni(t,e){if(Mr.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Qr){t:{try{Br(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ri[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ni.$.h.call(this)}}Or(ni,Mr);var ri={2:"touch",3:"pen",4:"mouse"};ni.prototype.h=function(){ni.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),si=0;function oi(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++si,this.fa=this.ia=!1}function ai(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function ci(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function ui(t){const e={};for(const n in t)e[n]=t[n];return e}const hi="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function li(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<hi.length;e++)n=hi[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function di(t){this.src=t,this.g={},this.h=0}function fi(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=Pr(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ai(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function pi(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}di.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=pi(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new oi(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var gi="closure_lm_"+(1e6*Math.random()|0),mi={};function yi(t,e,n,r,i){if(r&&r.once)return wi(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)yi(t,e[s],n,r,i);return null}return n=Ci(n),t&&t[ii]?t.O(e,n,Tr(r)?!!r.capture:!!r,i):vi(t,e,n,!1,r,i)}function vi(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Tr(i)?!!i.capture:!!i,a=Ti(t);if(a||(t[gi]=a=new di(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){const t=Ii;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ur||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(bi(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function wi(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)wi(t,e[s],n,r,i);return null}return n=Ci(n),t&&t[ii]?t.P(e,n,Tr(r)?!!r.capture:!!r,i):vi(t,e,n,!0,r,i)}function _i(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)_i(t,e[s],n,r,i);else r=Tr(r)?!!r.capture:!!r,n=Ci(n),t&&t[ii]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=pi(s=t.g[e],n,r,i))&&(ai(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Ti(t))&&(e=t.g[e.toString()],t=-1,e&&(t=pi(e,n,r,i)),(n=-1<t?e[t]:null)&&Ei(n))}function Ei(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[ii])fi(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(bi(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ti(e))?(fi(n,t),0==n.h&&(n.src=null,e[gi]=null)):ai(t)}}}function bi(t){return t in mi?mi[t]:mi[t]="on"+t}function Ii(t,e){if(t.fa)t=!0;else{e=new ni(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Ei(t),t=n.call(r,e)}return t}function Ti(t){return(t=t[gi])instanceof di?t:null}var Si="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ci(t){return"function"==typeof t?t:(t[Si]||(t[Si]=function(e){return t.handleEvent(e)}),t[Si])}function Ai(){Dr.call(this),this.i=new di(this),this.S=this,this.J=null}function ki(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new Mr(e,t);else if(e instanceof Mr)e.target=e.target||t;else{var i=e;li(e=new Mr(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Ni(o,r,!0,e)&&i}if(i=Ni(o=e.g=t,r,!0,e)&&i,i=Ni(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Ni(o=e.g=n[s],r,!1,e)&&i}function Ni(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&fi(t.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}Or(Ai,Dr),Ai.prototype[ii]=!0,Ai.prototype.removeEventListener=function(t,e,n,r){_i(this,t,e,n,r)},Ai.prototype.N=function(){if(Ai.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ai(n[r]);delete e.g[t],e.h--}}this.J=null},Ai.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Ai.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Ri=br.JSON.stringify;function Oi(){var t=Fi;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Di=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Pi),(t=>t.reset()));class Pi{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Li(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function xi(t){br.setTimeout((()=>{throw t}),0)}let Mi,Ui=!1,Fi=new class{constructor(){this.h=this.g=null}add(t,e){const n=Di.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Vi=()=>{const t=br.Promise.resolve(void 0);Mi=()=>{t.then(ji)}};var ji=()=>{for(var t;t=Oi();){try{t.h.call(t.g)}catch(t){xi(t)}var e=Di;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ui=!1};function Bi(t,e){Ai.call(this),this.h=t||1,this.g=e||br,this.j=Nr(this.qb,this),this.l=Date.now()}function $i(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Hi(t,e,n){if("function"==typeof t)n&&(t=Nr(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Nr(t.handleEvent,t)}return 2147483647<Number(e)?-1:br.setTimeout(t,e||0)}function zi(t){t.g=Hi((()=>{t.g=null,t.i&&(t.i=!1,zi(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Or(Bi,Ai),(vr=Bi.prototype).ga=!1,vr.T=null,vr.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ki(this,"tick"),this.ga&&($i(this),this.start()))}},vr.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},vr.N=function(){Bi.$.N.call(this),$i(this),delete this.g};class qi extends Dr{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:zi(this)}N(){super.N(),this.g&&(br.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gi(t){Dr.call(this),this.h=t,this.g={}}Or(Gi,Dr);var Ki=[];function Wi(t,e,n,r){Array.isArray(n)||(n&&(Ki[0]=n.toString()),n=Ki);for(var i=0;i<n.length;i++){var s=yi(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Qi(t){ci(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ei(t)}),t),t.g={}}function Xi(){this.g=!0}function Ji(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ri(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Gi.prototype.N=function(){Gi.$.N.call(this),Qi(this)},Gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Xi.prototype.Ea=function(){this.g=!1},Xi.prototype.info=function(){};var Yi={},Zi=null;function ts(){return Zi=Zi||new Ai}function es(t){Mr.call(this,Yi.Ta,t)}function ns(t){const e=ts();ki(e,new es(e))}function rs(t,e){Mr.call(this,Yi.STAT_EVENT,t),this.stat=e}function is(t){const e=ts();ki(e,new rs(e,t))}function ss(t,e){Mr.call(this,Yi.Ua,t),this.size=e}function os(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return br.setTimeout((function(){t()}),e)}Yi.Ta="serverreachability",Or(es,Mr),Yi.STAT_EVENT="statevent",Or(rs,Mr),Yi.Ua="timingevent",Or(ss,Mr);var as={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},cs={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function us(){}function hs(t){return t.h||(t.h=t.i())}function ls(){}us.prototype.h=null;var ds,fs={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ps(){Mr.call(this,"d")}function gs(){Mr.call(this,"c")}function ms(){}function ys(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Gi(this),this.P=ws,t=Wr?125:void 0,this.V=new Bi(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new vs}function vs(){this.i=null,this.g="",this.h=!1}Or(ps,Mr),Or(gs,Mr),Or(ms,us),ms.prototype.g=function(){return new XMLHttpRequest},ms.prototype.i=function(){return{}},ds=new ms;var ws=45e3,_s={},Es={};function bs(t,e,n){t.L=1,t.A=Bs(Ms(e)),t.u=n,t.S=!0,Is(t,null)}function Is(t,e){t.G=Date.now(),As(t),t.B=Ms(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),to(n.i,"t",r),t.o=0,n=t.l.J,t.h=new vs,t.g=ea(t.l,n?e:null,!t.u),0<t.O&&(t.M=new qi(Nr(t.Pa,t,t.g),t.O)),Wi(t.U,t.g,"readystatechange",t.nb),e=t.I?ui(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),ns(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Ts(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Ss(t,e,n){let r,i=!0;for(;!t.J&&t.o<n.length;){if(r=Cs(t,n),r==Es){4==e&&(t.s=4,is(14),i=!1),Ji(t.j,t.m,null,"[Incomplete Response]");break}if(r==_s){t.s=4,is(15),Ji(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Ji(t.j,t.m,r,null),Ds(t,r)}Ts(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,is(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ko(e),e.M=!0,is(11))):(Ji(t.j,t.m,n,"[Invalid Chunked Response]"),Os(t),Rs(t))}function Cs(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?Es:(n=Number(e.substring(n,r)),isNaN(n)?_s:(r+=1)+n>e.length?Es:(e=e.slice(r,r+n),t.o=r+n,e))}function As(t){t.Y=Date.now()+t.P,ks(t,t.P)}function ks(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=os(Nr(t.lb,t),e)}function Ns(t){t.C&&(br.clearTimeout(t.C),t.C=null)}function Rs(t){0==t.l.H||t.J||Xo(t.l,t)}function Os(t){Ns(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,$i(t.V),Qi(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ds(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||ao(n.i,t)))if(!t.K&&ao(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;Qo(n),Vo(n)}Go(n),is(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=os(Nr(n.ib,n),6e3));if(1>=oo(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Yo(n,11)}else if((t.K||n.g==t)&&Qo(n),!Fr(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const e=u[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const i=u[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(co(s,s.h),s.h=null))}if(r.F){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.Da=t,js(r.I,r.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=ta(r,r.J?r.pa:null,r.Y),o.K){uo(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Ns(a),As(a)),r.g=o}else qo(r);0<n.j.length&&Bo(n)}else"stop"!=u[0]&&"close"!=u[0]||Yo(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Yo(n,7):Fo(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}ns()}catch(t){}}function Ps(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ir(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Ir(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Ir(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(vr=ys.prototype).setTimeout=function(t){this.P=t},vr.nb=function(t){t=t.target;const e=this.M;e&&3==Do(t)?e.l():this.Pa(t)},vr.Pa=function(t){try{if(t==this.g)t:{const h=Do(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||Wr||this.g&&(this.h.h||this.g.ja()||Po(this.g)))){this.J||4!=h||7==e||ns(),Ns(this);var n=this.g.da();this.ca=n;e:if(Ts(this)){var r=Po(this.g);t="";var i=r.length,s=4==Do(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Os(this),Rs(this);var o="";break e}this.h.i=new br.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Fr(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.s=3,is(12),Os(this),Rs(this);break t}Ji(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ds(this,n)}this.S?(Ss(this,h,o),Wr&&this.i&&3==h&&(Wi(this.U,this.V,"tick",this.mb),this.V.start())):(Ji(this.j,this.m,o,null),Ds(this,o)),4==h&&Os(this),this.i&&!this.J&&(4==h?Xo(this.l,this):(this.i=!1,As(this)))}else(function(t){const e={};t=(t.g&&2<=Do(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(Fr(t[r]))continue;var n=Li(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,is(12)):(this.s=0,is(13)),Os(this),Rs(this)}}}catch(t){}},vr.mb=function(){if(this.g){var t=Do(this.g),e=this.g.ja();this.o<e.length&&(Ns(this),Ss(this,t,e),this.i&&4!=t&&As(this))}},vr.cancel=function(){this.J=!0,Os(this)},vr.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(ns(),is(17)),Os(this),this.s=2,Rs(this)):ks(this,this.Y-t)};var Ls=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof xs){this.h=t.h,Us(this,t.j),this.s=t.s,this.g=t.g,Fs(this,t.m),this.l=t.l;var e=t.i,n=new Xs;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Vs(this,n),this.o=t.o}else t&&(e=String(t).match(Ls))?(this.h=!1,Us(this,e[1]||"",!0),this.s=$s(e[2]||""),this.g=$s(e[3]||"",!0),Fs(this,e[4]),this.l=$s(e[5]||"",!0),Vs(this,e[6]||"",!0),this.o=$s(e[7]||"")):(this.h=!1,this.i=new Xs(null,this.h))}function Ms(t){return new xs(t)}function Us(t,e,n){t.j=n?$s(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Fs(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Vs(t,e,n){e instanceof Xs?(t.i=e,function(t,e){e&&!t.j&&(Js(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ys(this,e),to(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Hs(e,Ws)),t.i=new Xs(e,t.h))}function js(t,e,n){t.i.set(e,n)}function Bs(t){return js(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $s(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Hs(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,zs),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function zs(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}xs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Hs(e,qs,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Hs(e,qs,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Hs(n,"/"==n.charAt(0)?Ks:Gs,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Hs(n,Qs)),t.join("")};var qs=/[#\/\?@]/g,Gs=/[#\?:]/g,Ks=/[#\?]/g,Ws=/[#\?@]/g,Qs=/#/g;function Xs(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Js(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ys(t,e){Js(t),e=eo(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Zs(t,e){return Js(t),e=eo(t,e),t.g.has(e)}function to(t,e,n){Ys(t,e),0<n.length&&(t.i=null,t.g.set(eo(t,e),Lr(n)),t.h+=n.length)}function eo(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(vr=Xs.prototype).add=function(t,e){Js(this),this.i=null,t=eo(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},vr.forEach=function(t,e){Js(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},vr.ta=function(){Js(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},vr.Z=function(t){Js(this);let e=[];if("string"==typeof t)Zs(this,t)&&(e=e.concat(this.g.get(eo(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},vr.set=function(t,e){return Js(this),this.i=null,Zs(this,t=eo(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},vr.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},vr.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var no=class{constructor(t,e){this.g=t,this.map=e}};function ro(t){this.l=t||io,t=br.PerformanceNavigationTiming?0<(t=br.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(br.g&&br.g.Ka&&br.g.Ka()&&br.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var io=10;function so(t){return!!t.h||!!t.g&&t.g.size>=t.j}function oo(t){return t.h?1:t.g?t.g.size:0}function ao(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function co(t,e){t.g?t.g.add(e):t.h=e}function uo(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ho(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Lr(t.i)}ro.prototype.cancel=function(){if(this.i=ho(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var lo=class{stringify(t){return br.JSON.stringify(t,void 0)}parse(t){return br.JSON.parse(t,void 0)}};function fo(){this.g=new lo}function po(t,e,n){const r=n||"";try{Ps(t,(function(t,n){let i=t;Tr(t)&&(i=Ri(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function go(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function mo(t){this.l=t.ec||null,this.j=t.ob||!1}function yo(t,e){Ai.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=vo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Or(mo,us),mo.prototype.g=function(){return new yo(this.l,this.j)},mo.prototype.i=function(t){return function(){return t}}({}),Or(yo,Ai);var vo=0;function wo(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function _o(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Eo(t)}function Eo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(vr=yo.prototype).open=function(t,e){if(this.readyState!=vo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Eo(this)},vr.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||br).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},vr.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,_o(this)),this.readyState=vo},vr.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Eo(this)),this.g&&(this.readyState=3,Eo(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==br.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wo(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},vr.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?_o(this):Eo(this),3==this.readyState&&wo(this)}},vr.Za=function(t){this.g&&(this.response=this.responseText=t,_o(this))},vr.Ya=function(t){this.g&&(this.response=t,_o(this))},vr.ka=function(){this.g&&_o(this)},vr.setRequestHeader=function(t,e){this.v.append(t,e)},vr.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},vr.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(yo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var bo=br.JSON.parse;function Io(t){Ai.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=To,this.L=this.M=!1}Or(Io,Ai);var To="",So=/^https?$/i,Co=["POST","PUT"];function Ao(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ko(t),Ro(t)}function ko(t){t.F||(t.F=!0,ki(t,"complete"),ki(t,"error"))}function No(t){if(t.h&&void 0!==Er&&(!t.C[1]||4!=Do(t)||2!=t.da()))if(t.v&&4==Do(t))Hi(t.La,0,t);else if(ki(t,"readystatechange"),4==Do(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(Ls)[1]||null;!i&&br.self&&br.self.location&&(i=br.self.location.protocol.slice(0,-1)),r=!So.test(i?i.toLowerCase():"")}n=r}if(n)ki(t,"complete"),ki(t,"success");else{t.m=6;try{var s=2<Do(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",ko(t)}}finally{Ro(t)}}}function Ro(t,e){if(t.g){Oo(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ki(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Oo(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(br.clearTimeout(t.A),t.A=null)}function Do(t){return t.g?t.g.readyState:0}function Po(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case To:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Lo(t){let e="";return ci(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function xo(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Lo(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):js(t,e,n))}function Mo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Uo(t){this.Ga=0,this.j=[],this.l=new Xi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Mo("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Mo("baseRetryDelayMs",5e3,t),this.hb=Mo("retryDelaySeedMs",1e4,t),this.eb=Mo("forwardChannelMaxRetries",2,t),this.xa=Mo("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new ro(t&&t.concurrentRequestLimit),this.Ja=new fo,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Fo(t){if(jo(t),3==t.H){var e=t.W++,n=Ms(t.I);if(js(n,"SID",t.K),js(n,"RID",e),js(n,"TYPE","terminate"),Ho(t,n),(e=new ys(t,t.l,e)).L=2,e.A=Bs(Ms(n)),n=!1,br.navigator&&br.navigator.sendBeacon)try{n=br.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&br.Image&&((new Image).src=e.A,n=!0),n||(e.g=ea(e.l,null),e.g.ha(e.A)),e.G=Date.now(),As(e)}Zo(t)}function Vo(t){t.g&&(Ko(t),t.g.cancel(),t.g=null)}function jo(t){Vo(t),t.u&&(br.clearTimeout(t.u),t.u=null),Qo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&br.clearTimeout(t.m),t.m=null)}function Bo(t){if(!so(t.i)&&!t.m){t.m=!0;var e=t.Na;Mi||Vi(),Ui||(Mi(),Ui=!0),Fi.add(e,t),t.C=0}}function $o(t,e){var n;n=e?e.m:t.W++;const r=Ms(t.I);js(r,"SID",t.K),js(r,"RID",n),js(r,"AID",t.V),Ho(t,r),t.o&&t.s&&xo(r,t.o,t.s),n=new ys(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=zo(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),co(t.i,n),bs(n,r,e)}function Ho(t,e){t.na&&ci(t.na,(function(t,n){js(e,n,t)})),t.h&&Ps({},(function(t,n){js(e,n,t)}))}function zo(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Nr(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),s=!1;else try{po(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,r}function qo(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Mi||Vi(),Ui||(Mi(),Ui=!0),Fi.add(e,t),t.A=0}}function Go(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=os(Nr(t.Ma,t),Jo(t,t.A)),t.A++,0))}function Ko(t){null!=t.B&&(br.clearTimeout(t.B),t.B=null)}function Wo(t){t.g=new ys(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Ms(t.wa);js(e,"RID","rpc"),js(e,"SID",t.K),js(e,"AID",t.V),js(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&js(e,"TO",t.qa),js(e,"TYPE","xmlhttp"),Ho(t,e),t.o&&t.s&&xo(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Bs(Ms(e)),n.u=null,n.S=!0,Is(n,t)}function Qo(t){null!=t.v&&(br.clearTimeout(t.v),t.v=null)}function Xo(t,e){var n=null;if(t.g==e){Qo(t),Ko(t),t.g=null;var r=2}else{if(!ao(t.i,e))return;n=e.F,uo(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;ki(r=ts(),new ss(r,n)),Bo(t)}else qo(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function(t,e){return!(oo(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=os(Nr(t.Na,t,e),Jo(t,t.C)),t.C++,0)))}(t,e)||2==r&&Go(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Yo(t,5);break;case 4:Yo(t,10);break;case 3:Yo(t,6);break;default:Yo(t,2)}}function Jo(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Yo(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=Nr(t.pb,t);n||(n=new xs("//www.google.com/images/cleardot.gif"),br.location&&"http"==br.location.protocol||Us(n,"https"),Bs(n)),function(t,e){const n=new Xi;if(br.Image){const r=new Image;r.onload=Rr(go,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Rr(go,n,r,"TestLoadImage: error",!1,e),r.onabort=Rr(go,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Rr(go,n,r,"TestLoadImage: timeout",!1,e),br.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else is(2);t.H=0,t.h&&t.h.za(e),Zo(t),jo(t)}function Zo(t){if(t.H=0,t.ma=[],t.h){const e=ho(t.i);0==e.length&&0==t.j.length||(xr(t.ma,e),xr(t.ma,t.j),t.i.i.length=0,Lr(t.j),t.j.length=0),t.h.ya()}}function ta(t,e,n){var r=n instanceof xs?Ms(n):new xs(n);if(""!=r.g)e&&(r.g=e+"."+r.g),Fs(r,r.m);else{var i=br.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new xs(null);r&&Us(s,r),e&&(s.g=e),i&&Fs(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&js(r,n,e),js(r,"VER",t.ra),Ho(t,r),r}function ea(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Io(new mo({ob:n})):new Io(t.va)).Oa(t.J),e}function na(){}function ra(){if(Gr&&!(10<=Number(ei)))throw Error("Environmental error: no available transport.")}function ia(t,e){Ai.call(this),this.g=new Uo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Fr(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Fr(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new aa(this)}function sa(t){ps.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function oa(){gs.call(this),this.status=1}function aa(t){this.g=t}function ca(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ua(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function ha(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(vr=Io.prototype).Oa=function(t){this.M=t},vr.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ds.g(),this.C=this.u?hs(this.u):hs(ds),this.g.onreadystatechange=Nr(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Ao(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=br.FormData&&t instanceof br.FormData,!(0<=Pr(Co,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Oo(this),0<this.B&&((this.L=function(t){return Gr&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Nr(this.ua,this)):this.A=Hi(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Ao(this,t)}},vr.ua=function(){void 0!==Er&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ki(this,"timeout"),this.abort(8))},vr.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ki(this,"complete"),ki(this,"abort"),Ro(this))},vr.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ro(this,!0)),Io.$.N.call(this)},vr.La=function(){this.s||(this.G||this.v||this.l?No(this):this.kb())},vr.kb=function(){No(this)},vr.isActive=function(){return!!this.g},vr.da=function(){try{return 2<Do(this)?this.g.status:-1}catch(t){return-1}},vr.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},vr.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),bo(e)}},vr.Ia=function(){return this.m},vr.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(vr=Uo.prototype).ra=8,vr.H=1,vr.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new ys(this,this.l,t);let s=this.s;if(this.U&&(s?(s=ui(s),li(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=zo(this,i,e),js(n=Ms(this.I),"RID",t),js(n,"CVER",22),this.F&&js(n,"X-HTTP-Session-Id",this.F),Ho(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Lo(s)))+"&"+e:this.o&&xo(n,this.o,s)),co(this.i,i),this.bb&&js(n,"TYPE","init"),this.P?(js(n,"$req",e),js(n,"SID","null"),i.aa=!0,bs(i,n,null)):bs(i,n,e),this.H=2}}else 3==this.H&&(t?$o(this,t):0==this.j.length||so(this.i)||$o(this))},vr.Ma=function(){if(this.u=null,Wo(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=os(Nr(this.jb,this),t)}},vr.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,is(10),Vo(this),Wo(this))},vr.ib=function(){null!=this.v&&(this.v=null,Vo(this),Go(this),is(19))},vr.pb=function(t){t?(this.l.info("Successfully pinged google.com"),is(2)):(this.l.info("Failed to ping google.com"),is(1))},vr.isActive=function(){return!!this.h&&this.h.isActive(this)},(vr=na.prototype).Ba=function(){},vr.Aa=function(){},vr.za=function(){},vr.ya=function(){},vr.isActive=function(){return!0},vr.Va=function(){},ra.prototype.g=function(t,e){return new ia(t,e)},Or(ia,Ai),ia.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;is(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=ta(t,null,t.Y),Bo(t)},ia.prototype.close=function(){Fo(this.g)},ia.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Ri(t),t=n);e.j.push(new no(e.fb++,t)),3==e.H&&Bo(e)},ia.prototype.N=function(){this.g.h=null,delete this.j,Fo(this.g),delete this.g,ia.$.N.call(this)},Or(sa,ps),Or(oa,gs),Or(aa,na),aa.prototype.Ba=function(){ki(this.g,"a")},aa.prototype.Aa=function(t){ki(this.g,new sa(t))},aa.prototype.za=function(t){ki(this.g,new oa)},aa.prototype.ya=function(){ki(this.g,"b")},Or(ca,(function(){this.blockSize=-1})),ca.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},ca.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)ua(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){ua(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){ua(this,r),i=0;break}}this.h=i,this.i+=e},ca.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var la={};function da(t){return-128<=t&&128>t?function(t,e){var n=la;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new ha([0|t],0>t?-1:0)}(t)}(t):new ha([0|t],0>t?-1:0)}function fa(t){if(isNaN(t)||!isFinite(t))return ga;if(0>t)return _a(fa(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=pa;return new ha(e,0)}var pa=4294967296,ga=da(0),ma=da(1),ya=da(16777216);function va(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function wa(t){return-1==t.h}function _a(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new ha(n,~t.h).add(ma)}function Ea(t,e){return t.add(_a(e))}function ba(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ia(t,e){this.g=t,this.h=e}function Ta(t,e){if(va(e))throw Error("division by zero");if(va(t))return new Ia(ga,ga);if(wa(t))return e=Ta(_a(t),e),new Ia(_a(e.g),_a(e.h));if(wa(e))return e=Ta(t,_a(e)),new Ia(_a(e.g),e.h);if(30<t.g.length){if(wa(t)||wa(e))throw Error("slowDivide_ only works with positive integers.");for(var n=ma,r=e;0>=r.X(t);)n=Sa(n),r=Sa(r);var i=Ca(n,1),s=Ca(r,1);for(r=Ca(r,2),n=Ca(n,2);!va(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ca(r,1),n=Ca(n,1)}return e=Ea(t,i.R(e)),new Ia(i,e)}for(i=ga;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=fa(n)).R(e);wa(o)||0<o.X(t);)o=(s=fa(n-=r)).R(e);va(s)&&(s=ma),i=i.add(s),t=Ea(t,o)}return new Ia(i,t)}function Sa(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new ha(n,t.h)}function Ca(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ha(i,t.h)}(vr=ha.prototype).ea=function(){if(wa(this))return-_a(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:pa+r)*e,e*=pa}return t},vr.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(va(this))return"0";if(wa(this))return"-"+_a(this).toString(t);for(var e=fa(Math.pow(t,6)),n=this,r="";;){var i=Ta(n,e).g,s=((0<(n=Ea(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(va(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},vr.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},vr.X=function(t){return wa(t=Ea(this,t))?-1:va(t)?0:1},vr.abs=function(){return wa(this)?_a(this):this},vr.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new ha(n,-2147483648&n[n.length-1]?-1:0)},vr.R=function(t){if(va(this)||va(t))return ga;if(wa(this))return wa(t)?_a(this).R(_a(t)):_a(_a(this).R(t));if(wa(t))return _a(this.R(_a(t)));if(0>this.X(ya)&&0>t.X(ya))return fa(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,c=65535&t.D(i);n[2*r+2*i]+=o*c,ba(n,2*r+2*i),n[2*r+2*i+1]+=s*c,ba(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ba(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ba(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new ha(n,0)},vr.gb=function(t){return Ta(this,t).h},vr.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new ha(n,this.h&t.h)},vr.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new ha(n,this.h|t.h)},vr.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new ha(n,this.h^t.h)},ra.prototype.createWebChannel=ra.prototype.g,ia.prototype.send=ia.prototype.u,ia.prototype.open=ia.prototype.m,ia.prototype.close=ia.prototype.close,as.NO_ERROR=0,as.TIMEOUT=8,as.HTTP_ERROR=6,cs.COMPLETE="complete",ls.EventType=fs,fs.OPEN="a",fs.CLOSE="b",fs.ERROR="c",fs.MESSAGE="d",Ai.prototype.listen=Ai.prototype.O,Io.prototype.listenOnce=Io.prototype.P,Io.prototype.getLastError=Io.prototype.Sa,Io.prototype.getLastErrorCode=Io.prototype.Ia,Io.prototype.getStatus=Io.prototype.da,Io.prototype.getResponseJson=Io.prototype.Wa,Io.prototype.getResponseText=Io.prototype.ja,Io.prototype.send=Io.prototype.ha,Io.prototype.setWithCredentials=Io.prototype.Oa,ca.prototype.digest=ca.prototype.l,ca.prototype.reset=ca.prototype.reset,ca.prototype.update=ca.prototype.j,ha.prototype.add=ha.prototype.add,ha.prototype.multiply=ha.prototype.R,ha.prototype.modulo=ha.prototype.gb,ha.prototype.compare=ha.prototype.X,ha.prototype.toNumber=ha.prototype.ea,ha.prototype.toString=ha.prototype.toString,ha.prototype.getBits=ha.prototype.D,ha.fromNumber=fa,ha.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return _a(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=fa(Math.pow(n,8)),i=ga,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=fa(Math.pow(n,o)),i=i.R(o).add(fa(a))):i=(i=i.R(r)).add(fa(a))}return i};var Aa=_r.createWebChannelTransport=function(){return new ra},ka=_r.getStatEventTarget=function(){return ts()},Na=_r.ErrorCode=as,Ra=_r.EventType=cs,Oa=_r.Event=Yi,Da=_r.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Pa=(_r.FetchXmlHttpFactory=mo,_r.WebChannel=ls),La=_r.XhrIo=Io,xa=(_r.Md5=ca,_r.Integer=ha);const Ma="@firebase/firestore";class Ua{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ua.UNAUTHENTICATED=new Ua(null),Ua.GOOGLE_CREDENTIALS=new Ua("google-credentials-uid"),Ua.FIRST_PARTY=new Ua("first-party-uid"),Ua.MOCK_USER=new Ua("mock-user");let Fa="10.8.0";const Va=new M("@firebase/firestore");function ja(){return Va.logLevel}function Ba(t,...e){if(Va.logLevel<=O.DEBUG){const n=e.map(za);Va.debug(`Firestore (${Fa}): ${t}`,...n)}}function $a(t,...e){if(Va.logLevel<=O.ERROR){const n=e.map(za);Va.error(`Firestore (${Fa}): ${t}`,...n)}}function Ha(t,...e){if(Va.logLevel<=O.WARN){const n=e.map(za);Va.warn(`Firestore (${Fa}): ${t}`,...n)}}function za(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function qa(t="Unexpected state"){const e=`FIRESTORE (${Fa}) INTERNAL ASSERTION FAILED: `+t;throw $a(e),new Error(e)}function Ga(t,e){t||qa()}function Ka(t,e){return t}const Wa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qa extends g{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xa{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Ja{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Ya{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Ua.UNAUTHENTICATED)))}shutdown(){}}class Za{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class tc{constructor(t){this.t=t,this.currentUser=Ua.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Xa;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xa,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{Ba("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ba("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xa)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ba("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Ga("string"==typeof e.accessToken),new Ja(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ga(null===t||"string"==typeof t),new Ua(t)}}class ec{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=Ua.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class nc{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new ec(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(Ua.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class rc{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ic{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Ba("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Ba("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{Ba("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?r(t):Ba("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Ga("string"==typeof t.token),this.R=t.token,new rc(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function sc(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class oc{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=sc(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function ac(t,e){return t<e?-1:t>e?1:0}function cc(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}class uc{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Qa(Wa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Qa(Wa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Qa(Wa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Qa(Wa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return uc.fromMillis(Date.now())}static fromDate(t){return uc.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new uc(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ac(this.nanoseconds,t.nanoseconds):ac(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class hc{constructor(t){this.timestamp=t}static fromTimestamp(t){return new hc(t)}static min(){return new hc(new uc(0,0))}static max(){return new hc(new uc(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lc{constructor(t,e,n){void 0===e?e=0:e>t.length&&qa(),void 0===n?n=t.length-e:n>t.length-e&&qa(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===lc.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof lc?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class dc extends lc{construct(t,e,n){return new dc(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Qa(Wa.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new dc(e)}static emptyPath(){return new dc([])}}const fc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pc extends lc{construct(t,e,n){return new pc(t,e,n)}static isValidIdentifier(t){return fc.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pc.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new pc(["__name__"])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Qa(Wa.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new Qa(Wa.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Qa(Wa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new Qa(Wa.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new pc(e)}static emptyPath(){return new pc([])}}class gc{constructor(t){this.path=t}static fromPath(t){return new gc(dc.fromString(t))}static fromName(t){return new gc(dc.fromString(t).popFirst(5))}static empty(){return new gc(dc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===dc.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return dc.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new gc(new dc(t.slice()))}}function mc(t){return new yc(t.readTime,t.key,-1)}class yc{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new yc(hc.min(),gc.empty(),-1)}static max(){return new yc(hc.max(),gc.empty(),-1)}}function vc(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=gc.comparator(t.documentKey,e.documentKey),0!==n?n:ac(t.largestBatchId,e.largestBatchId))}const wc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _c{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Ec(t){if(t.code!==Wa.FAILED_PRECONDITION||t.message!==wc)throw t;Ba("LocalStore","Unexpectedly lost primary lease")}class bc{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&qa(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new bc(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof bc?e:bc.resolve(e)}catch(t){return bc.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):bc.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):bc.reject(e)}static resolve(t){return new bc(((e,n)=>{e(t)}))}static reject(t){return new bc(((e,n)=>{n(t)}))}static waitFor(t){return new bc(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=bc.resolve(!1);for(const n of t)e=e.next((t=>t?bc.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}static mapArray(t,e){return new bc(((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===i&&n(s)}),(t=>r(t)))}}))}static doWhile(t,e){return new bc(((n,r)=>{const i=()=>{!0===t()?e().next((()=>{i()}),r):n()};i()}))}}class Ic{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Xa,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Cc(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Oc(e.target.error);this.V.reject(new Cc(t,n))}}static open(t,e,n,r){try{return new Ic(e,t.transaction(r,n))}catch(t){throw new Cc(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Ba("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new kc(e)}}class Tc{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Tc.S(f())&&$a("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Ba("SimpleDb","Removing database:",t),Nc(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!p())return!1;if(Tc.C())return!0;const t=f(),e=Tc.S(t),n=0<e&&e<10,r=Tc.v(t),i=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||i)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(Ba("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=t=>{const n=t.target.result;e(n)},r.onblocked=()=>{n(new Cc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=e=>{const r=e.target.error;"VersionError"===r.name?n(new Qa(Wa.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Qa(Wa.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Cc(t,r))},r.onupgradeneeded=t=>{Ba("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,r.transaction,t.oldVersion,this.version).next((()=>{Ba("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,r){const i="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=Ic.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),bc.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(Ba("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Sc{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Nc(this.k.delete())}}class Cc extends Qa{constructor(t,e){super(Wa.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ac(t){return"IndexedDbTransactionError"===t.name}class kc{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Ba("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ba("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Nc(n)}add(t){return Ba("SimpleDb","ADD",this.store.name,t,t),Nc(this.store.add(t))}get(t){return Nc(this.store.get(t)).next((e=>(void 0===e&&(e=null),Ba("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return Ba("SimpleDb","DELETE",this.store.name,t),Nc(this.store.delete(t))}count(){return Ba("SimpleDb","COUNT",this.store.name),Nc(this.store.count())}W(t,e){const n=this.options(t,e),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const t=r.getAll(n.range);return new bc(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new bc(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){Ba("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const r=this.cursor(n);return this.G(r,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.G(r,e)}Z(t){const e=this.cursor({});return new bc(((n,r)=>{e.onerror=t=>{const e=Oc(t.target.error);r(e)},e.onsuccess=e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next((t=>{t?r.continue():n()})):n()}}))}G(t,e){const n=[];return new bc(((r,i)=>{t.onerror=t=>{i(t.target.error)},t.onsuccess=t=>{const i=t.target.result;if(!i)return void r();const s=new Sc(i),o=e(i.primaryKey,i.value,s);if(o instanceof bc){const t=o.catch((t=>(s.done(),bc.reject(t))));n.push(t)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>bc.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Nc(t){return new bc(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Oc(t.target.error);n(e)}}))}let Rc=!1;function Oc(t){const e=Tc.S(f());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new Qa("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Rc||(Rc=!0,setTimeout((()=>{throw t}),0)),t}}return t}class Dc{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Pc(t){return null==t}function Lc(t){return 0===t&&1/t==-1/0}Dc._e=-1;function xc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Mc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Uc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Fc{constructor(t,e){this.comparator=t,this.root=e||jc.EMPTY}insert(t,e){return new Fc(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,jc.BLACK,null,null))}remove(t){return new Fc(this.comparator,this.root.remove(t,this.comparator).copy(null,null,jc.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Vc(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Vc(this.root,t,this.comparator,!1)}getReverseIterator(){return new Vc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Vc(this.root,t,this.comparator,!0)}}class Vc{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class jc{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:jc.RED,this.left=null!=r?r:jc.EMPTY,this.right=null!=i?i:jc.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new jc(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jc.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return jc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,jc.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,jc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qa();if(this.right.isRed())throw qa();const t=this.left.check();if(t!==this.right.check())throw qa();return t+(this.isRed()?0:1)}}jc.EMPTY=null,jc.RED=!0,jc.BLACK=!1,jc.EMPTY=new class{constructor(){this.size=0}get key(){throw qa()}get value(){throw qa()}get color(){throw qa()}get left(){throw qa()}get right(){throw qa()}copy(t,e,n,r,i){return this}insert(t,e,n){return new jc(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bc{constructor(t){this.comparator=t,this.data=new Fc(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new $c(this.data.getIterator())}getIteratorFrom(t){return new $c(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Bc))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Bc(this.comparator);return e.data=t,e}}class $c{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Hc{constructor(t){this.fields=t,t.sort(pc.comparator)}static empty(){return new Hc([])}unionWith(t){let e=new Bc(pc.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Hc(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return cc(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class zc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class qc{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new zc("Invalid base64 string: "+t):t}}(t);return new qc(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new qc(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ac(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}qc.EMPTY_BYTE_STRING=new qc("");const Gc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Kc(t){if(Ga(!!t),"string"==typeof t){let e=0;const n=Gc.exec(t);if(Ga(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Wc(t.seconds),nanos:Wc(t.nanos)}}function Wc(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Qc(t){return"string"==typeof t?qc.fromBase64String(t):qc.fromUint8Array(t)}function Xc(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Jc(t){const e=t.mapValue.fields.__previous_value__;return Xc(e)?Jc(e):e}function Yc(t){const e=Kc(t.mapValue.fields.__local_write_time__.timestampValue);return new uc(e.seconds,e.nanos)}class Zc{constructor(t,e,n,r,i,s,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class tu{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new tu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof tu&&t.projectId===this.projectId&&t.database===this.database}}const eu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function nu(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xc(t)?4:fu(t)?9007199254740991:10:qa()}function ru(t,e){if(t===e)return!0;const n=nu(t);if(n!==nu(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yc(t).isEqual(Yc(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Kc(t.timestampValue),r=Kc(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Qc(t.bytesValue).isEqual(Qc(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Wc(t.geoPointValue.latitude)===Wc(e.geoPointValue.latitude)&&Wc(t.geoPointValue.longitude)===Wc(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Wc(t.integerValue)===Wc(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Wc(t.doubleValue),r=Wc(e.doubleValue);return n===r?Lc(n)===Lc(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return cc(t.arrayValue.values||[],e.arrayValue.values||[],ru);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(xc(n)!==xc(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!ru(n[t],r[t])))return!1;return!0}(t,e);default:return qa()}}function iu(t,e){return void 0!==(t.values||[]).find((t=>ru(t,e)))}function su(t,e){if(t===e)return 0;const n=nu(t),r=nu(e);if(n!==r)return ac(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ac(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Wc(t.integerValue||t.doubleValue),r=Wc(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ou(t.timestampValue,e.timestampValue);case 4:return ou(Yc(t),Yc(e));case 5:return ac(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Qc(t),r=Qc(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=ac(n[t],r[t]);if(0!==e)return e}return ac(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ac(Wc(t.latitude),Wc(e.latitude));return 0!==n?n:ac(Wc(t.longitude),Wc(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=su(n[t],r[t]);if(e)return e}return ac(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===eu.mapValue&&e===eu.mapValue)return 0;if(t===eu.mapValue)return 1;if(e===eu.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=ac(r[t],s[t]);if(0!==e)return e;const o=su(n[r[t]],i[s[t]]);if(0!==o)return o}return ac(r.length,s.length)}(t.mapValue,e.mapValue);default:throw qa()}}function ou(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ac(t,e);const n=Kc(t),r=Kc(e),i=ac(n.seconds,r.seconds);return 0!==i?i:ac(n.nanos,r.nanos)}function au(t){return cu(t)}function cu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Kc(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Qc(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return gc.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=cu(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${cu(t.fields[i])}`;return n+"}"}(t.mapValue):qa()}function uu(t){return!!t&&"integerValue"in t}function hu(t){return!!t&&"arrayValue"in t}function lu(t){return!!t&&"mapValue"in t}function du(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Mc(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=du(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=du(t.arrayValue.values[n]);return e}return Object.assign({},t)}function fu(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class pu{constructor(t){this.value=t}static empty(){return new pu({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!lu(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=du(e)}setAll(t){let e=pc.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=du(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());lu(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ru(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];lu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){Mc(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new pu(du(this.value))}}function gu(t){const e=[];return Mc(t.fields,((t,n)=>{const r=new pc([t]);if(lu(n)){const t=gu(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)})),new Hc(e)}class mu{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new mu(t,0,hc.min(),hc.min(),hc.min(),pu.empty(),0)}static newFoundDocument(t,e,n,r){return new mu(t,1,e,hc.min(),n,r,0)}static newNoDocument(t,e){return new mu(t,2,e,hc.min(),hc.min(),pu.empty(),0)}static newUnknownDocument(t,e){return new mu(t,3,e,hc.min(),hc.min(),pu.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(hc.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=pu.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=pu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=hc.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof mu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new mu(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yu{constructor(t,e){this.position=t,this.inclusive=e}}function vu(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?gc.comparator(gc.fromName(o.referenceValue),n.key):su(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function wu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ru(t.position[n],e.position[n]))return!1;return!0}class _u{constructor(t,e="asc"){this.field=t,this.dir=e}}function Eu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class bu{}class Iu extends bu{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Ru(t,e,n):"array-contains"===e?new Lu(t,n):"in"===e?new xu(t,n):"not-in"===e?new Mu(t,n):"array-contains-any"===e?new Uu(t,n):new Iu(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Ou(t,n):new Du(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(su(e,this.value)):null!==e&&nu(this.value)===nu(e)&&this.matchesComparison(su(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return qa()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tu extends bu{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Tu(t,e)}matches(t){return Su(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Su(t){return"and"===t.op}function Cu(t){return function(t){for(const e of t.filters)if(e instanceof Tu)return!1;return!0}(t)&&Su(t)}function Au(t){if(t instanceof Iu)return t.field.canonicalString()+t.op.toString()+au(t.value);if(Cu(t))return t.filters.map((t=>Au(t))).join(",");{const e=t.filters.map((t=>Au(t))).join(",");return`${t.op}(${e})`}}function ku(t,e){return t instanceof Iu?function(t,e){return e instanceof Iu&&t.op===e.op&&t.field.isEqual(e.field)&&ru(t.value,e.value)}(t,e):t instanceof Tu?function(t,e){return e instanceof Tu&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,r)=>t&&ku(n,e.filters[r])),!0)}(t,e):void qa()}function Nu(t){return t instanceof Iu?function(t){return`${t.field.canonicalString()} ${t.op} ${au(t.value)}`}(t):t instanceof Tu?function(t){return t.op.toString()+" {"+t.getFilters().map(Nu).join(" ,")+"}"}(t):"Filter"}class Ru extends Iu{constructor(t,e,n){super(t,e,n),this.key=gc.fromName(n.referenceValue)}matches(t){const e=gc.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ou extends Iu{constructor(t,e){super(t,"in",e),this.keys=Pu(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Du extends Iu{constructor(t,e){super(t,"not-in",e),this.keys=Pu(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Pu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>gc.fromName(t.referenceValue)))}class Lu extends Iu{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return hu(e)&&iu(e.arrayValue,this.value)}}class xu extends Iu{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&iu(this.value.arrayValue,e)}}class Mu extends Iu{constructor(t,e){super(t,"not-in",e)}matches(t){if(iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!iu(this.value.arrayValue,e)}}class Uu extends Iu{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!hu(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>iu(this.value.arrayValue,t)))}}class Fu{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function Vu(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Fu(t,e,n,r,i,s,o)}function ju(t){const e=Ka(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Au(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Pc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>au(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>au(t))).join(",")),e.ce=t}return e.ce}function Bu(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Eu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ku(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wu(t.startAt,e.startAt)&&wu(t.endAt,e.endAt)}class $u{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Hu(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function zu(t){const e=Ka(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new Bc(pc.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);r.forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.le.push(new _u(r,n))})),t.has(pc.keyField().canonicalString())||e.le.push(new _u(pc.keyField(),n))}return e.le}function qu(t){const e=Ka(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return Vu(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new _u(t.field,e)}));const n=t.endAt?new yu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new yu(t.startAt.position,t.startAt.inclusive):null;return Vu(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,zu(t))),e.he}function Gu(t,e,n){return new $u(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ku(t,e){return Bu(qu(t),qu(e))&&t.limitType===e.limitType}function Wu(t){return`${ju(qu(t))}|lt:${t.limitType}`}function Qu(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Nu(t))).join(", ")}]`),Pc(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>au(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>au(t))).join(",")),`Target(${e})`}(qu(t))}; limitType=${t.limitType})`}function Xu(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):gc.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of zu(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=vu(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,zu(t),e)||t.endAt&&!function(t,e,n){const r=vu(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,zu(t),e))}(t,e)}function Ju(t,e,n){const r=t.field.isKeyField()?gc.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?su(r,i):qa()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return qa()}}class Yu{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Mc(this.inner,((e,n)=>{for(const[e,r]of n)t(e,r)}))}isEmpty(){return Uc(this.inner)}size(){return this.innerSize}}const Zu=new Fc(gc.comparator);function th(){return Zu}const eh=new Fc(gc.comparator);function nh(...t){let e=eh;for(const n of t)e=e.insert(n.key,n);return e}function rh(t){let e=eh;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function ih(){return oh()}function sh(){return oh()}function oh(){return new Yu((t=>t.toString()),((t,e)=>t.isEqual(e)))}const ah=new Fc(gc.comparator),ch=new Bc(gc.comparator);function uh(...t){let e=ch;for(const n of t)e=e.add(n);return e}const hh=new Bc(ac);function lh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lc(e)?"-0":e}}function dh(t){return{integerValue:""+t}}function fh(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Lc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?dh(e):lh(t,e)}class ph{constructor(){this._=void 0}}function gh(t,e,n){return t instanceof vh?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Xc(e)&&(e=Jc(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof wh?_h(t,e):t instanceof Eh?bh(t,e):function(t,e){const n=yh(t,e),r=Th(n)+Th(t.Ie);return uu(n)&&uu(t.Ie)?dh(r):lh(t.serializer,r)}(t,e)}function mh(t,e,n){return t instanceof wh?_h(t,e):t instanceof Eh?bh(t,e):n}function yh(t,e){return t instanceof Ih?function(t){return uu(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class vh extends ph{}class wh extends ph{constructor(t){super(),this.elements=t}}function _h(t,e){const n=Sh(e);for(const e of t.elements)n.some((t=>ru(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Eh extends ph{constructor(t){super(),this.elements=t}}function bh(t,e){let n=Sh(e);for(const e of t.elements)n=n.filter((t=>!ru(t,e)));return{arrayValue:{values:n}}}class Ih extends ph{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Th(t){return Wc(t.integerValue||t.doubleValue)}function Sh(t){return hu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ch{constructor(t,e){this.version=t,this.transformResults=e}}class Ah{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ah}static exists(t){return new Ah(void 0,t)}static updateTime(t){return new Ah(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function kh(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Nh{}function Rh(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new jh(t.key,Ah.none()):new xh(t.key,t.data,Ah.none());{const n=t.data,r=pu.empty();let i=new Bc(pc.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new Mh(t.key,r,new Hc(i.toArray()),Ah.none())}}function Oh(t,e,n){t instanceof xh?function(t,e,n){const r=t.value.clone(),i=Fh(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Mh?function(t,e,n){if(!kh(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=Fh(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Uh(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Dh(t,e,n,r){return t instanceof xh?function(t,e,n,r){if(!kh(t.precondition,e))return n;const i=t.value.clone(),s=Vh(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof Mh?function(t,e,n,r){if(!kh(t.precondition,e))return n;const i=Vh(t.fieldTransforms,r,e),s=e.data;return s.setAll(Uh(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,r):function(t,e,n){return kh(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Ph(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),i=yh(r.transform,t||null);null!=i&&(null===n&&(n=pu.empty()),n.set(r.field,i))}return n||null}function Lh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&cc(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof wh&&e instanceof wh||t instanceof Eh&&e instanceof Eh?cc(t.elements,e.elements,ru):t instanceof Ih&&e instanceof Ih?ru(t.Ie,e.Ie):t instanceof vh&&e instanceof vh}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class xh extends Nh{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Mh extends Nh{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Uh(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function Fh(t,e,n){const r=new Map;Ga(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,mh(o,a,n[i]))}return r}function Vh(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,gh(t,s,e))}return r}class jh extends Nh{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bh extends Nh{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $h{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&Oh(r,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Dh(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Dh(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=sh();return this.mutations.forEach((r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=Rh(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(hc.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),uh())}isEqual(t){return this.batchId===t.batchId&&cc(this.mutations,t.mutations,((t,e)=>Lh(t,e)))&&cc(this.baseMutations,t.baseMutations,((t,e)=>Lh(t,e)))}}class Hh{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){Ga(t.mutations.length===n.length);let r=ah;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.insert(i[t].key,n[t].version);return new Hh(t,e,n,r)}}class zh{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var qh,Gh;(Gh=qh||(qh={}))[Gh.OK=0]="OK",Gh[Gh.CANCELLED=1]="CANCELLED",Gh[Gh.UNKNOWN=2]="UNKNOWN",Gh[Gh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gh[Gh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gh[Gh.NOT_FOUND=5]="NOT_FOUND",Gh[Gh.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gh[Gh.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gh[Gh.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gh[Gh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gh[Gh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gh[Gh.ABORTED=10]="ABORTED",Gh[Gh.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gh[Gh.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gh[Gh.INTERNAL=13]="INTERNAL",Gh[Gh.UNAVAILABLE=14]="UNAVAILABLE",Gh[Gh.DATA_LOSS=15]="DATA_LOSS",new xa([4294967295,4294967295],0),Error;class Kh{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Wh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Xh(t,e){return Wh(t,e.toTimestamp())}function Jh(t){return Ga(!!t),hc.fromTimestamp(function(t){const e=Kc(t);return new uc(e.seconds,e.nanos)}(t))}function Yh(t,e){return Zh(t,e).canonicalString()}function Zh(t,e){const n=function(t){return new dc(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function tl(t,e){return Yh(t.databaseId,e.path)}function el(t){const e=function(t){const e=dc.fromString(t);return Ga(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?dc.emptyPath():function(t){return Ga(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function nl(t,e,n){return{name:tl(t,e),fields:n.value.mapValue.fields}}function rl(t){let e=el(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ga(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=il(t);return e instanceof Tu&&Cu(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new _u(sl(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Pc(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new yu(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new yu(n,e)}(n.endAt)),function(t,e,n,r,i,s,o,a){return new $u(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",c,u)}function il(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=sl(t.unaryFilter.field);return Iu.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=sl(t.unaryFilter.field);return Iu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=sl(t.unaryFilter.field);return Iu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=sl(t.unaryFilter.field);return Iu.create(i,"!=",{nullValue:"NULL_VALUE"});default:return qa()}}(t):void 0!==t.fieldFilter?function(t){return Iu.create(sl(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return qa()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Tu.create(t.compositeFilter.filters.map((t=>il(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return qa()}}(t.compositeFilter.op))}(t):qa()}function sl(t){return pc.fromServerFormat(t.fieldPath)}function ol(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class al{constructor(t){this.ct=t}}function cl(t){const e=rl({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Gu(e,e.limit,"L"):e}class ul{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Wc(t.integerValue));else if("doubleValue"in t){const n=Wc(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),Lc(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(Qc(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?fu(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):qa()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),gc.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}ul.bt=new ul;class hl{constructor(){this._n=new ll}addToCollectionParentIndex(t,e){return this._n.add(e),bc.resolve()}getCollectionParents(t,e){return bc.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return bc.resolve()}deleteFieldIndex(t,e){return bc.resolve()}deleteAllFieldIndexes(t){return bc.resolve()}createTargetIndexes(t,e){return bc.resolve()}getDocumentsMatchingTarget(t,e){return bc.resolve(null)}getIndexType(t,e){return bc.resolve(0)}getFieldIndexes(t,e){return bc.resolve([])}getNextCollectionGroupToUpdate(t){return bc.resolve(null)}getMinOffset(t,e){return bc.resolve(yc.min())}getMinOffsetFromCollectionGroup(t,e){return bc.resolve(yc.min())}updateCollectionGroup(t,e,n){return bc.resolve()}updateIndexEntries(t,e){return bc.resolve()}}class ll{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Bc(dc.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new Bc(dc.comparator)).toArray()}}new Uint8Array(0);class dl{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new dl(t,dl.DEFAULT_COLLECTION_PERCENTILE,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}dl.DEFAULT_COLLECTION_PERCENTILE=10,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dl.DEFAULT=new dl(41943040,dl.DEFAULT_COLLECTION_PERCENTILE,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dl.DISABLED=new dl(-1,0,0);class fl{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new fl(0)}static Bn(){return new fl(-1)}}class pl{constructor(){this.changes=new Yu((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,mu.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?bc.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class gl{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class ml{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(n=r,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Dh(n.mutation,t,Hc.empty(),uc.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,uh()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=uh()){const r=ih();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,n).next((t=>{let e=nh();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=ih();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,uh())))}populateOverlays(t,e,n){const r=[];return n.forEach((t=>{e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,r){let i=th();const s=oh(),o=oh();return e.forEach(((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof Mh)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),Dh(o.mutation,e,o.mutation.getFieldMask(),uc.now())):s.set(e.key,Hc.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new gl(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=oh();let r=new Fc(((t,e)=>t-e)),i=uh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Hc.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||uh()).add(t);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=sh();c.forEach((t=>{if(!i.has(t)){const r=Rh(e.get(t),n.get(t));null!==r&&u.set(t,r),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,u))}return bc.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return gc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):bc.resolve(ih());let o=-1,a=i;return s.next((e=>bc.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?bc.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,uh()))).next((t=>({batchId:o,changes:rh(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new gc(e)).next((t=>{let e=nh();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=nh();return this.indexManager.getCollectionParents(t,i).next((o=>bc.forEach(o,(o=>{const a=function(t,e){return new $u(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)))).next((t=>{i.forEach(((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,mu.newInvalidDocument(r)))}));let n=nh();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&Dh(s.mutation,r,Hc.empty(),uc.now()),Xu(e,r)&&(n=n.insert(t,r))})),n}))}}class yl{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return bc.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Jh(t.createTime)}}(e)),bc.resolve()}getNamedQuery(t,e){return bc.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:cl(t.bundledQuery),readTime:Jh(t.readTime)}}(e)),bc.resolve()}}class vl{constructor(){this.overlays=new Fc(gc.comparator),this.hr=new Map}getOverlay(t,e){return bc.resolve(this.overlays.get(e))}getOverlays(t,e){const n=ih();return bc.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,r)=>{this.ht(t,e,r)})),bc.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),bc.resolve()}getOverlaysForCollection(t,e,n){const r=ih(),i=e.length+1,s=new gc(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return bc.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new Fc(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=ih(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=ih(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=r)););return bc.resolve(o)}ht(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new zh(e,n));let i=this.hr.get(e);void 0===i&&(i=uh(),this.hr.set(e,i)),this.hr.set(e,i.add(n.key))}}class wl{constructor(){this.Pr=new Bc(_l.Ir),this.Tr=new Bc(_l.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new _l(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new _l(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new gc(new dc([])),n=new _l(e,t),r=new _l(e,t+1),i=[];return this.Tr.forEachInRange([n,r],(t=>{this.Ar(t),i.push(t.key)})),i}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new gc(new dc([])),n=new _l(e,t),r=new _l(e,t+1);let i=uh();return this.Tr.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new _l(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class _l{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return gc.comparator(t.key,e.key)||ac(t.pr,e.pr)}static Er(t,e){return ac(t.pr,e.pr)||gc.comparator(t.key,e.key)}}class El{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new Bc(_l.Ir)}checkEmpty(t){return bc.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new $h(i,e,n,r);this.mutationQueue.push(s);for(const e of r)this.wr=this.wr.add(new _l(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return bc.resolve(s)}lookupMutationBatch(t,e){return bc.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.br(n),i=r<0?0:r;return bc.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return bc.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return bc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new _l(e,0),r=new _l(e,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(t=>{const e=this.Sr(t.pr);i.push(e)})),bc.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Bc(ac);return e.forEach((t=>{const e=new _l(t,0),r=new _l(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,r],(t=>{n=n.add(t.pr)}))})),bc.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;gc.isDocumentKey(i)||(i=i.child(""));const s=new _l(new gc(i),0);let o=new Bc(ac);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.pr)),!0)}),s),bc.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Ga(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return bc.forEach(e.mutations,(r=>{const i=new _l(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new _l(e,0),r=this.wr.firstAfterOrEqual(n);return bc.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,bc.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class bl{constructor(t){this.vr=t,this.docs=new Fc(gc.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return bc.resolve(n?n.document.mutableCopy():mu.newInvalidDocument(e))}getEntries(t,e){let n=th();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():mu.newInvalidDocument(t))})),bc.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=th();const s=e.path,o=new gc(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||vc(mc(o),n)<=0||(r.has(o.key)||Xu(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return bc.resolve(i)}getAllFromCollectionGroup(t,e,n,r){qa()}Fr(t,e){return bc.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Il(this)}getSize(t){return bc.resolve(this.size)}}class Il extends pl{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?e.push(this.ar.addEntry(t,r)):this.ar.removeEntry(n)})),bc.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Tl{constructor(t){this.persistence=t,this.Mr=new Yu((t=>ju(t)),Bu),this.lastRemoteSnapshotVersion=hc.min(),this.highestTargetId=0,this.Or=0,this.Nr=new wl,this.targetCount=0,this.Br=fl.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),bc.resolve()}getLastRemoteSnapshotVersion(t){return bc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return bc.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),bc.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),bc.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new fl(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,bc.resolve()}updateTargetData(t,e){return this.qn(e),bc.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,bc.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),bc.waitFor(i).next((()=>r))}getTargetCount(t){return bc.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return bc.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),bc.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),bc.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),bc.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return bc.resolve(n)}containsKey(t,e){return bc.resolve(this.Nr.containsKey(e))}}class Sl{constructor(t,e){this.Lr={},this.overlays={},this.kr=new Dc(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Tl(this),this.indexManager=new hl,this.remoteDocumentCache=function(t){return new bl(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new al(e),this.$r=new yl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new vl,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new El(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){Ba("MemoryPersistence","Starting transaction:",t);const r=new Cl(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((t=>this.referenceDelegate.Wr(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Gr(t,e){return bc.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class Cl extends _c{constructor(t){super(),this.currentSequenceNumber=t}}class Al{constructor(t){this.persistence=t,this.zr=new wl,this.jr=null}static Hr(t){return new Al(t)}get Jr(){if(this.jr)return this.jr;throw qa()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),bc.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),bc.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),bc.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bc.forEach(this.Jr,(n=>{const r=gc.fromPath(n);return this.Yr(t,r).next((t=>{t||e.removeEntry(r,hc.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return bc.or([()=>bc.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class kl{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=r}static Ki(t,e){let n=uh(),r=uh();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new kl(t,e.fromCache,n,r)}}class Nl{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Rl{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var e;const n=null===(e=o())||void 0===e?void 0:e.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(t.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Tc.v(f())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ji(t,e).next((t=>{i.result=t})).next((()=>{if(!i.result)return this.Hi(t,e,r,n).next((t=>{i.result=t}))})).next((()=>{if(i.result)return;const n=new Nl;return this.Ji(t,e,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(t,e,n,r.size)}))})).next((()=>i.result))}Yi(t,e,n,r){return n.documentReadCount<this.Wi?(ja()<=O.DEBUG&&Ba("QueryEngine","SDK will not create cache indexes for query:",Qu(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),bc.resolve()):(ja()<=O.DEBUG&&Ba("QueryEngine","Query:",Qu(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(ja()<=O.DEBUG&&Ba("QueryEngine","The SDK decides to create cache indexes for query:",Qu(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,qu(e))):bc.resolve())}ji(t,e){if(Hu(e))return bc.resolve(null);let n=qu(e);return this.indexManager.getIndexType(t,n).next((r=>0===r?null:(null!==e.limit&&1===r&&(e=Gu(e,null,"F"),n=qu(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((r=>{const i=uh(...r);return this.zi.getDocuments(t,i).next((r=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,r);return this.Xi(e,s,i,n.readTime)?this.ji(t,Gu(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,r){return Hu(e)||r.isEqual(hc.min())?bc.resolve(null):this.zi.getDocuments(t,n).next((i=>{const s=this.Zi(e,i);return this.Xi(e,s,n,r)?bc.resolve(null):(ja()<=O.DEBUG&&Ba("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qu(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=hc.fromTimestamp(1e9===r?new uc(n+1,0):new uc(n,r));return new yc(i,gc.empty(),e)}(r,-1)).next((t=>t)))}))}Zi(t,e){let n=new Bc(function(t){return(e,n)=>{let r=!1;for(const i of zu(t)){const t=Ju(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}(t));return e.forEach(((e,r)=>{Xu(t,r)&&(n=n.add(r))})),n}Xi(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(t,e,n){return ja()<=O.DEBUG&&Ba("QueryEngine","Using full collection scan to execute query:",Qu(e)),this.zi.getDocumentsMatchingQuery(t,e,yc.min(),n)}es(t,e,n,r){return this.zi.getDocumentsMatchingQuery(t,n,r).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ol{constructor(t,e,n,r){this.persistence=t,this.ts=e,this.serializer=r,this.ns=new Fc(ac),this.rs=new Yu((t=>ju(t)),Bu),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ml(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function Dl(t,e){const n=Ka(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next((i=>(r=i,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let o=uh();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function Pl(t,e){const n=Ka(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class Ll{constructor(){this.activeTargetIds=hh}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class xl{constructor(){this.no=new Ll,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Ll,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Ml{io(t){}shutdown(){}}class Ul{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Ba("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){Ba("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Fl=null;function Vl(){return null===Fl?Fl=268435456+Math.round(2147483648*Math.random()):Fl++,"0x"+Fl.toString(16)}const jl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bl{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const $l="WebChannelConnection";class Hl extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(t,e,n,r,i){const s=Vl(),o=this.bo(t,e.toUriEncodedString());Ba("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(t,o,a,n).then((e=>(Ba("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw Ha("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,r,i,s){return this.So(t,e,n,r,i)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Fa,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=jl[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,r){const i=Vl();return new Promise(((s,o)=>{const a=new La;a.setWithCredentials(!0),a.listenOnce(Ra.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Na.NO_ERROR:const e=a.getResponseJson();Ba($l,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),s(e);break;case Na.TIMEOUT:Ba($l,`RPC '${t}' ${i} timed out`),o(new Qa(Wa.DEADLINE_EXCEEDED,"Request time out"));break;case Na.HTTP_ERROR:const n=a.getStatus();if(Ba($l,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Wa).indexOf(e)>=0?e:Wa.UNKNOWN}(e.status);o(new Qa(t,e.message))}else o(new Qa(Wa.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Qa(Wa.UNAVAILABLE,"Connection failed."));break;default:qa()}}finally{Ba($l,`RPC '${t}' ${i} completed.`)}}));const c=JSON.stringify(r);Ba($l,`RPC '${t}' ${i} sending request:`,r),a.send(e,"POST",c,n,15)}))}Fo(t,e,n){const r=Vl(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Aa(),o=ka(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const u=i.join("");Ba($l,`Creating RPC '${t}' stream ${r}: ${u}`,a);const h=s.createWebChannel(u,a);let l=!1,d=!1;const f=new Bl({lo:e=>{d?Ba($l,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(l||(Ba($l,`Opening RPC '${t}' stream ${r} transport.`),h.open(),l=!0),Ba($l,`RPC '${t}' stream ${r} sending:`,e),h.send(e))},ho:()=>h.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(h,Pa.EventType.OPEN,(()=>{d||Ba($l,`RPC '${t}' stream ${r} transport opened.`)})),p(h,Pa.EventType.CLOSE,(()=>{d||(d=!0,Ba($l,`RPC '${t}' stream ${r} transport closed`),f.Vo())})),p(h,Pa.EventType.ERROR,(e=>{d||(d=!0,Ha($l,`RPC '${t}' stream ${r} transport errored:`,e),f.Vo(new Qa(Wa.UNAVAILABLE,"The operation could not be completed")))})),p(h,Pa.EventType.MESSAGE,(e=>{var n;if(!d){const i=e.data[0];Ga(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Ba($l,`RPC '${t}' stream ${r} received error:`,o);const e=o.status;let n=function(t){const e=qh[t];if(void 0!==e)return function(t){if(void 0===t)return $a("GRPC error has no .code"),Wa.UNKNOWN;switch(t){case qh.OK:return Wa.OK;case qh.CANCELLED:return Wa.CANCELLED;case qh.UNKNOWN:return Wa.UNKNOWN;case qh.DEADLINE_EXCEEDED:return Wa.DEADLINE_EXCEEDED;case qh.RESOURCE_EXHAUSTED:return Wa.RESOURCE_EXHAUSTED;case qh.INTERNAL:return Wa.INTERNAL;case qh.UNAVAILABLE:return Wa.UNAVAILABLE;case qh.UNAUTHENTICATED:return Wa.UNAUTHENTICATED;case qh.INVALID_ARGUMENT:return Wa.INVALID_ARGUMENT;case qh.NOT_FOUND:return Wa.NOT_FOUND;case qh.ALREADY_EXISTS:return Wa.ALREADY_EXISTS;case qh.PERMISSION_DENIED:return Wa.PERMISSION_DENIED;case qh.FAILED_PRECONDITION:return Wa.FAILED_PRECONDITION;case qh.ABORTED:return Wa.ABORTED;case qh.OUT_OF_RANGE:return Wa.OUT_OF_RANGE;case qh.UNIMPLEMENTED:return Wa.UNIMPLEMENTED;case qh.DATA_LOSS:return Wa.DATA_LOSS;default:return qa()}}(e)}(e),i=o.message;void 0===n&&(n=Wa.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new Qa(n,i)),h.close()}else Ba($l,`RPC '${t}' stream ${r} received:`,i),f.mo(i)}})),p(o,Oa.STAT_EVENT,(e=>{e.stat===Da.PROXY?Ba($l,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===Da.NOPROXY&&Ba($l,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function zl(){return"undefined"!=typeof document?document:null}function ql(t){return new Kh(t,!0)}class Gl{constructor(t,e,n=1e3,r=1.5,i=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),r=Math.max(0,e-n);r>0&&Ba("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class Kl{constructor(t,e,n,r,i,s,o,a){this.oi=t,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Gl(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===Wa.RESOURCE_EXHAUSTED?($a(e.toString()),$a("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===Wa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new Qa(Wa.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return Ba("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(Ba("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Wl extends Kl{constructor(t,e,n,r,i,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(Ga(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(Ga(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Jh(t.updateTime):Jh(e);return n.isEqual(hc.min())&&(n=Jh(e)),new Ch(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Jh(t.commitTime);return this.listener.T_(n,e)}return Ga(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=function(t){return new dc(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof xh)n={update:nl(t,e.key,e.value)};else if(e instanceof jh)n={delete:tl(t,e.key)};else if(e instanceof Mh)n={update:nl(t,e.key,e.data),updateMask:ol(e.fieldMask)};else{if(!(e instanceof Bh))return qa();n={verify:tl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof vh)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wh)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Eh)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ih)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw qa()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Xh(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:qa()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class Ql extends class{}{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new Qa(Wa.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.So(t,Zh(e,n),r,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Wa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Qa(Wa.UNKNOWN,t.toString())}))}vo(t,e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Zh(e,n),r,s,o,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Wa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Qa(Wa.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Xl{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?($a(e),this.g_=!1):Ba("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Jl{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((t=>{n.enqueueAndForget((async()=>{td(this)&&(Ba("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Ka(t);e.v_.add(4),await Zl(e),e.x_.set("Unknown"),e.v_.delete(4),await Yl(e)}(this))}))})),this.x_=new Xl(n,r)}}async function Yl(t){if(td(t))for(const e of t.F_)await e(!0)}async function Zl(t){for(const e of t.F_)await e(!1)}function td(t){return 0===Ka(t).v_.size}async function ed(t,e,n){if(!Ac(e))throw e;t.v_.add(1),await Zl(t),t.x_.set("Offline"),n||(n=()=>function(t){const e=Ka(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ba("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await Yl(t)}))}function nd(t,e){return e().catch((n=>ed(t,n,e)))}async function rd(t){const e=Ka(t),n=fd(e);let r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;id(e);)try{const t=await Pl(e.localStore,r);if(null===t){0===e.D_.length&&n.Xo();break}r=t.batchId,sd(e,t)}catch(t){await ed(e,t)}od(e)&&ad(e)}function id(t){return td(t)&&t.D_.length<10}function sd(t,e){t.D_.push(e);const n=fd(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function od(t){return td(t)&&!fd(t).Ho()&&t.D_.length>0}function ad(t){fd(t).start()}async function cd(t){fd(t).d_()}async function ud(t){const e=fd(t);for(const n of t.D_)e.I_(n.mutations)}async function hd(t,e,n){const r=t.D_.shift(),i=Hh.from(r,e,n);await nd(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await rd(t)}async function ld(t,e){e&&fd(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return qa();case Wa.CANCELLED:case Wa.UNKNOWN:case Wa.DEADLINE_EXCEEDED:case Wa.RESOURCE_EXHAUSTED:case Wa.INTERNAL:case Wa.UNAVAILABLE:case Wa.UNAUTHENTICATED:return!1;case Wa.INVALID_ARGUMENT:case Wa.NOT_FOUND:case Wa.ALREADY_EXISTS:case Wa.PERMISSION_DENIED:case Wa.FAILED_PRECONDITION:case Wa.ABORTED:case Wa.OUT_OF_RANGE:case Wa.UNIMPLEMENTED:case Wa.DATA_LOSS:return!0}}(t)&&t!==Wa.ABORTED}(e.code)){const n=t.D_.shift();fd(t).Zo(),await nd(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await rd(t)}}(t,e),od(t)&&ad(t)}async function dd(t,e){const n=Ka(t);n.asyncQueue.verifyOperationInProgress(),Ba("RemoteStore","RemoteStore received new credentials");const r=td(n);n.v_.add(3),await Zl(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await Yl(n)}function fd(t){return t.B_||(t.B_=function(t,e,n){const r=Ka(t);return r.R_(),new Wl(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:cd.bind(null,t),To:ld.bind(null,t),E_:ud.bind(null,t),T_:hd.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await rd(t)):(await t.B_.stop(),t.D_.length>0&&(Ba("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class pd{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Xa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new pd(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Qa(Wa.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gd(t,e){if($a("AsyncQueue",`${e}: ${t}`),Ac(t))return new Qa(Wa.UNAVAILABLE,`${e}: ${t}`);throw t}class md{constructor(){this.queries=new Yu((t=>Wu(t)),Ku),this.onlineState="Unknown",this.K_=new Set}}class yd{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new Yu((t=>Wu(t)),Ku),this.pa=new Map,this.ya=new Set,this.wa=new Fc(gc.comparator),this.Sa=new Map,this.ba=new wl,this.Da={},this.Ca=new Map,this.va=fl.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}function vd(t,e,n){const r=Ka(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.ga.forEach(((n,r)=>{const i=r.view.U_(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=Ka(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(r=!0)})),r&&function(t){t.K_.forEach((t=>{t.next()}))}(n)}(r.eventManager,e),t.length&&r.fa.u_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wd(t,e){const n=Ka(t),r=e.batch.batchId;try{const t=await function(t,e){const n=Ka(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const r=e.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=bc.resolve();return s.forEach((t=>{o=o.next((()=>r.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Ga(null!==s),e.version.compareTo(s)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=uh();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(n.localStore,e);bd(n,r,null),Ed(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Id(n,t)}catch(t){await Ec(t)}}async function _d(t,e,n){const r=Ka(t);try{const t=await function(t,e){const n=Ka(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Ga(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(r.localStore,e);bd(r,e,n),Ed(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Id(r,t)}catch(n){await Ec(n)}}function Ed(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function bd(t,e,n){const r=Ka(t);let i=r.Da[r.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}async function Id(t,e,n){const r=Ka(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach(((t,a)=>{o.push(r.Ma(a,e,n).then((t=>{if((t||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=kl.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.fa.u_(i),await async function(t,e){const n=Ka(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>bc.forEach(e,(e=>bc.forEach(e.qi,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>bc.forEach(e.Qi,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Ac(t))throw t;Ba("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,i)}}}(r.localStore,s))}async function Td(t,e){const n=Ka(t);if(!n.currentUser.isEqual(e)){Ba("SyncEngine","User change. New user:",e.toKey());const t=await Dl(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new Qa(Wa.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Id(n,t.us)}}function Sd(t){const e=Ka(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wd.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_d.bind(null,e),e}class Cd{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=ql(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,r){return new Ol(t,e,n,r)}(this.persistence,new Rl,t.initialUser,this.serializer)}createPersistence(t){return new Sl(Al.Hr,this.serializer)}createSharedClientState(t){return new xl}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ad{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>vd(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Td.bind(null,this.syncEngine),await async function(t,e){const n=Ka(t);e?(n.v_.delete(2),await Yl(n)):e||(n.v_.add(2),await Zl(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new md}createDatastore(t){const e=ql(t.databaseInfo.databaseId),n=function(t){return new Hl(t)}(t.databaseInfo);return function(t,e,n,r){return new Ql(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new Jl(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,(t=>vd(this.syncEngine,t,0)),Ul.D()?new Ul:new Ml)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new yd(t,e,n,r,i,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=Ka(t);Ba("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await Zl(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class kd{constructor(t,e,n,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=Ua.UNAUTHENTICATED,this.clientId=oc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ba("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ba("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Qa(Wa.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Xa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=gd(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Nd(t,e){t.asyncQueue.verifyOperationInProgress(),Ba("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await Dl(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Rd(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ba("FirestoreClient","Using user provided OfflineComponentProvider");try{await Nd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===Wa.FAILED_PRECONDITION||t.code===Wa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;Ha("Error using user provided cache. Falling back to memory cache: "+n),await Nd(t,new Cd)}}else Ba("FirestoreClient","Using default OfflineComponentProvider"),await Nd(t,new Cd);return t._offlineComponents}(t);Ba("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>dd(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>dd(e.remoteStore,n))),t._onlineComponents=e}function Od(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ba("FirestoreClient","Using user provided OnlineComponentProvider"),await Rd(t,t._uninitializedComponentsProvider._online)):(Ba("FirestoreClient","Using default OnlineComponentProvider"),await Rd(t,new Ad))),t._onlineComponents}(t).then((t=>t.syncEngine))}function Dd(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Pd=new Map;function Ld(t,e,n){if(!n)throw new Qa(Wa.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xd(t){if(!gc.isDocumentKey(t))throw new Qa(Wa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Md(t){if(gc.isDocumentKey(t))throw new Qa(Wa.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ud(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":qa()}function Fd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Qa(Wa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ud(t);throw new Qa(Wa.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Vd{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Qa(Wa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Qa(Wa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new Qa(Wa.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Dd(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Qa(Wa.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new Qa(Wa.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new Qa(Wa.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class jd{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vd({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Qa(Wa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Qa(Wa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vd(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Ya;switch(t.type){case"firstParty":return new nc(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Qa(Wa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Pd.get(t);e&&(Ba("ComponentProvider","Removing Datastore"),Pd.delete(t),e.terminate())}(this),Promise.resolve()}}class Bd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Bd(this.firestore,t,this._query)}}class $d{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new $d(this.firestore,t,this._key)}}class Hd extends Bd{constructor(t,e,n){super(t,e,function(t){return new $u(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new $d(this.firestore,null,new gc(t))}withConverter(t){return new Hd(this.firestore,t,this._path)}}function zd(t,e,...n){if(t=S(t),Ld("collection","path",e),t instanceof jd){const r=dc.fromString(e,...n);return Md(r),new Hd(t,null,r)}{if(!(t instanceof $d||t instanceof Hd))throw new Qa(Wa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(dc.fromString(e,...n));return Md(r),new Hd(t.firestore,null,r)}}class qd{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Gl(this,"async_queue_retry"),this._u=()=>{const t=zl();t&&Ba("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=zl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=zl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new Xa;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Ac(t))throw t;Ba("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw $a("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const r=pd.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(r),r}au(){this.ru&&qa()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Gd extends jd{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new qd,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Kd(this),this._firestoreClient.terminate()}}function Kd(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new Zc(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Dd(r.experimentalLongPollingOptions),r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new kd(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class Wd{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Wd(qc.fromBase64String(t))}catch(t){throw new Qa(Wa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Wd(qc.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Qd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Qa(Wa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pc(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Xd{constructor(t){this._methodName=t}}class Jd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Qa(Wa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Qa(Wa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ac(this._lat,t._lat)||ac(this._long,t._long)}}const Yd=/^__.*__$/;class Zd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Mh(t,this.data,this.fieldMask,e,this.fieldTransforms):new xh(t,this.data,e,this.fieldTransforms)}}function tf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qa()}}class ef{constructor(t,e,n,r,i,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Eu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new ef(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.mu(t),r}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.Eu(),r}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return df(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(tf(this.du)&&Yd.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class nf{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||ql(t)}Su(t,e,n,r=!1){return new ef({du:t,methodName:e,wu:n,path:pc.emptyPath(),Vu:!1,yu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rf(t){const e=t._freezeSettings(),n=ql(t._databaseId);return new nf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sf(t,e,n,r,i,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);uf("Data must be an object, but it was:",o,r);const a=af(r,o);let c,u;if(s.merge)c=new Hc(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=hf(e,r,n);if(!o.contains(i))throw new Qa(Wa.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);ff(t,i)||t.push(i)}c=new Hc(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new Zd(new pu(a),c,u)}function of(t,e){if(cf(t=S(t)))return uf("Unsupported field value:",e,t),af(t,e);if(t instanceof Xd)return function(t,e){if(!tf(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=of(i,e.gu(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=S(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return fh(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=uc.fromDate(t);return{timestampValue:Wh(e.serializer,n)}}if(t instanceof uc){const n=new uc(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Wh(e.serializer,n)}}if(t instanceof Jd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wd)return{bytesValue:Qh(e.serializer,t._byteString)};if(t instanceof $d){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.pu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Yh(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${Ud(t)}`)}(t,e)}function af(t,e){const n={};return Uc(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mc(t,((t,r)=>{const i=of(r,e.Ru(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function cf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof uc||t instanceof Jd||t instanceof Wd||t instanceof $d||t instanceof Xd)}function uf(t,e,n){if(!cf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=Ud(n);throw"an object"===r?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function hf(t,e,n){if((e=S(e))instanceof Qd)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(lf)>=0)throw df(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qd(...e.split("."))._internalPath}catch(r){throw df(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw df("Field path arguments must be of type string or ",t,!1,void 0,n)}const lf=new RegExp("[~\\*/\\[\\]]");function df(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Qa(Wa.INVALID_ARGUMENT,a+t+c)}function ff(t,e){return t.some((t=>t.isEqual(e)))}function pf(t,e){const n=Fd(t.firestore,Gd),r=function(t,e,...n){if(t=S(t),1===arguments.length&&(e=oc.newId()),Ld("doc","path",e),t instanceof jd){const r=dc.fromString(e,...n);return xd(r),new $d(t,null,new gc(r))}{if(!(t instanceof $d||t instanceof Hd))throw new Qa(Wa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(dc.fromString(e,...n));return xd(r),new $d(t.firestore,t instanceof Hd?t.converter:null,new gc(r))}}(t),i=function(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}(t.converter,e);return function(t,e){return function(t,e){const n=new Xa;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const r=Sd(t);try{const t=await function(t,e){const n=Ka(t),r=uc.now(),i=e.reduce(((t,e)=>t.add(e.key)),uh());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=th(),c=uh();return n.os.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{s=i;const o=[];for(const t of e){const e=Ph(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Mh(t.key,e,gu(e.value.mapValue),Ah.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)})).next((e=>{o=e;const r=e.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:rh(s)})))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Da[t.currentUser.toKey()];r||(r=new Fc(ac)),r=r.insert(e,n),t.Da[t.currentUser.toKey()]=r}(r,t.batchId,n),await Id(r,t.changes),await rd(r.remoteStore)}catch(t){const e=gd(t,"Failed to persist write");n.reject(e)}}(await Od(t),e,n))),n.promise}(function(t){return t._firestoreClient||Kd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[sf(rf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ah.exists(!1))]).then((()=>r))}new WeakMap,function(t,e=!0){!function(t){Fa=t}(ft),ut(new C("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new Gd(new tc(t.getProvider("auth-internal")),new ic(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Qa(Wa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tu(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),mt(Ma,"4.4.2",t),mt(Ma,"4.4.2","esm2017")}();const gf="firebasestorage.googleapis.com";class mf extends g{constructor(t,e,n=0){super(wf(t),`Firebase Storage: ${e} (${wf(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,mf.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return wf(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var yf,vf;function wf(t){return"storage/"+t}function _f(t){return new mf(yf.INVALID_ARGUMENT,t)}function Ef(){return new mf(yf.APP_DELETED,"The Firebase app was deleted.")}!function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(yf||(yf={}));class bf{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=bf.makeFromUrl(t,e)}catch(e){return new bf(t,"")}if(""===n.path)return n;throw r=t,new mf(yf.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(t,e){let n=null;const r="([A-Za-z0-9.\\-_]+)",i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}const o=e.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${e===gf?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let e=0;e<a.length;e++){const r=a[e],i=r.regex.exec(t);if(i){const t=i[r.indices.bucket];let e=i[r.indices.path];e||(e=""),n=new bf(t,e),r.postModify(n);break}}if(null==n)throw function(t){return new mf(yf.INVALID_URL,"Invalid URL '"+t+"'.")}(t);return n}}class If{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function Tf(t,e,n,r){if(r<e)throw _f(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw _f(`Invalid value for '${t}'. Expected ${n} or less.`)}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(vf||(vf={}));class Sf{constructor(t,e,n,r,i,s,o,a,c,u,h,l=!0){this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=l,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=(t,e)=>{const n=this.resolve_,r=this.reject_,i=e.connection;if(e.wasSuccessCode)try{const t=this.callback_(i,i.getResponse());!function(t){return void 0!==t}(t)?n():n(t)}catch(t){r(t)}else if(null!==i){const t=new mf(yf.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");t.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,t)):r(t)}else e.canceled?r(this.appDelete_?Ef():new mf(yf.CANCELED,"User canceled the upload/download.")):r(new mf(yf.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new Cf(!1,null,!0)):this.backoffId_=function(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let u=!1;function h(...t){u||(u=!0,e.apply(null,t))}function l(e){i=setTimeout((()=>{i=null,t(f,c())}),e)}function d(){s&&clearTimeout(s)}function f(t,...e){if(u)return void d();if(t)return d(),void h.call(null,t,...e);if(c()||o)return d(),void h.call(null,t,...e);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),l(n)}let p=!1;function g(t){p||(p=!0,d(),u||(null!==i?(t||(a=2),clearTimeout(i),l(0)):t||(a=1)))}return l(0),s=setTimeout((()=>{o=!0,g(!0)}),n),g}(((t,e)=>{if(e)return void t(!1,new Cf(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=t=>{const e=t.loaded,n=t.lengthComputable?t.total:-1;null!==this.progressCallback_&&this.progressCallback_(e,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const e=n.getErrorCode()===vf.NO_ERROR,i=n.getStatus();if(!e||function(t,e){const n=t>=500&&t<600,r=-1!==[408,429].indexOf(t),i=-1!==e.indexOf(t);return n||r||i}(i,this.additionalRetryCodes_)&&this.retry){const e=n.getErrorCode()===vf.ABORT;return void t(!1,new Cf(!1,null,e))}const s=-1!==this.successCodes_.indexOf(i);t(!0,new Cf(s,n))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Cf{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}class Af{constructor(t,e){this._service=t,this._location=e instanceof bf?e:bf.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Af(t,e)}get root(){const t=new bf(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new bf(this._location.bucket,t);return new Af(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new mf(yf.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}function kf(t,e){const n=null==e?void 0:e.storageBucket;return null==n?null:bf.makeFromBucketSpec(n,t)}class Nf{constructor(t,e,n,r,i){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=gf,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?bf.makeFromBucketSpec(r,this._host):kf(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=bf.makeFromBucketSpec(this._url,t):this._bucket=kf(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Tf("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Tf("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Af(this,t)}_makeRequest(t,e,n,r,i=!0){if(this._deleted)return new If(Ef());{const s=function(t,e,n,r,i,s,o=!0){const a=function(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}(t.urlParams),c=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,s),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new Sf(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(t,this._appId,n,r,e,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(t,e){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,r).getPromise()}}const Rf="@firebase/storage",Of="0.12.1",Df="storage";ut(new C(Df,(function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Nf(n,r,i,e,ft)}),"PUBLIC").setMultipleInstances(!0)),mt(Rf,Of,""),mt(Rf,Of,"esm2017");var Pf={apiKey:"AIzaSyCFDHjyCkH0iQMHWYr8nVcO6IIBzHwxXec",authDomain:"artist-nft-d75ba.firebaseapp.com",projectId:"artist-nft-d75ba",storageBucket:"artist-nft-d75ba.appspot.com",messagingSenderId:"1045494293646",appId:"1:1045494293646:web:9a83d99847b9c7434c15df",measurementId:"G-NNSQZW2MNN"},Lf=pt(Pf),xf=(pt(Pf,"Secondary"),function(t=gt()){const e=ht(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=ht(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(v(n.getOptions(),null!=e?e:{}))return t;Pt(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:lr,persistence:[Rn,fn,gn]}),r=h("authTokenSyncURL");if(r){const t=(i=r,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>gr)return;const r=null==e?void 0:e.token;mr!==r&&(mr=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(t,e,n){S(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,r,i){S(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var i;const s=a("auth");s&&function(t,e,n){const r=Pe(t);Mt(r._canInitEmulator,r,"emulator-config-failed"),Mt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Be(e),{host:o,port:a}=function(t){const e=Be(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const t=i[1];return{host:t,port:$e(r.substr(t.length+1))}}{const[t,e]=r.split(":");return{host:t,port:$e(e)}}}(e),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`)}(Lf),function(t,e){const n="string"==typeof t?t:"(default)",r=ht("object"==typeof t?t:gt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=c("firestore");t&&function(t,e,n,r={}){var i;const s=(t=Fd(t,jd))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ha("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=Ua.MOCK_USER;else{e=d(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Qa(Wa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ua(s)}t._authCredentials=new Za(new Ja(e,n))}}(r,...t)}return r}(Lf));function Mf(t){return Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mf(t)}function Uf(){Uf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var s=e&&e.prototype instanceof y?e:y,o=Object.create(s.prototype),a=new R(r||[]);return i(o,"_invoke",{value:C(t,n,a)}),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};u(_,o,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(O([])));b&&b!==n&&r.call(b,o)&&(_=b);var I=w.prototype=y.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,s,o,a){var c=l(t[i],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==Mf(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,a)}))}a(c.arg)}var s;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return s=s?s.then(i,i):i()}})}function C(e,n,r){var i=d;return function(s,o){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===s)throw o;return{value:t,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var c=A(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=l(e,n,r);if("normal"===u.type){if(i=r.done?g:f,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=g,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var s=l(i,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(Mf(e)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=u(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},e.awrap=function(t){return{__await:t}},T(S.prototype),u(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new S(h(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(I),u(I,c,"Generator"),u(I,o,(function(){return this})),u(I,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;N(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Ff(t,e,n,r,i,s,o){try{var a=t[s](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function Vf(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){Ff(s,r,i,o,a,"next",t)}function a(t){Ff(s,r,i,o,a,"throw",t)}o(void 0)}))}}function jf(){return Bf.apply(this,arguments)}function Bf(){return Bf=Vf(Uf().mark((function t(){var e;return Uf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=new Date,document.getElementById("form").addEventListener("submit",function(){var t=Vf(Uf().mark((function t(n){var r;return Uf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,pf(zd(xf,"questions"),{name:document.getElementById("name").value,question:document.getElementById("question").value,dateYear:e.getFullYear(),dateDay:e.getDate(),dateMonth:e.getMonth()+1,userImg:"https://firebasestorage.googleapis.com/v0/b/artist-nft-d75ba.appspot.com/o/forum%2Fimg-for-popular-question.png?alt=media&token=50a9c358-0d74-4728-90e0-87a0c3f878ee",userImgWebp:"https://firebasestorage.googleapis.com/v0/b/artist-nft-d75ba.appspot.com/o/forum%2Fimg-for-popular-question.webp?alt=media&token=bcc135eb-fb24-4223-beb2-3cf4fb5774ee",about:"no purse as fully me or point. Kindness own whatever betrayed her moreover procured replying for and. Proposal indulged no do do sociable he throwing settling. Covered ten nor comfort offices carried. Age she way earnestly the fulfilled extremely. Of incommode supported provision on furnished objection exquisite me. Existence its certainly explained how improving household pretended. Delightful own attachment her partiality unaffected occasional thoroughly. Adieus it no wonder spirit houses. "});case 3:r=t.sent,console.log("Document written with ID: ",r.id),document.getElementById("form").reset();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log(e.getFullYear()),console.log(e.getMonth()+1),console.log(e.getDate());case 5:case"end":return t.stop()}}),t)}))),Bf.apply(this,arguments)}function $f(t){return $f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(t)}function Hf(){Hf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var s=e&&e.prototype instanceof y?e:y,o=Object.create(s.prototype),a=new R(r||[]);return i(o,"_invoke",{value:C(t,n,a)}),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};u(_,o,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(O([])));b&&b!==n&&r.call(b,o)&&(_=b);var I=w.prototype=y.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,s,o,a){var c=l(t[i],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==$f(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,a)}))}a(c.arg)}var s;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return s=s?s.then(i,i):i()}})}function C(e,n,r){var i=d;return function(s,o){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===s)throw o;return{value:t,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var c=A(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=l(e,n,r);if("normal"===u.type){if(i=r.done?g:f,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=g,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var s=l(i,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError($f(e)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=u(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},e.awrap=function(t){return{__await:t}},T(S.prototype),u(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new S(h(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(I),u(I,c,"Generator"),u(I,o,(function(){return this})),u(I,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;N(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function zf(t,e,n,r,i,s,o){try{var a=t[s](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function qf(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){zf(s,r,i,o,a,"next",t)}function a(t){zf(s,r,i,o,a,"throw",t)}o(void 0)}))}}!function(t=gt(),e){const n=ht(t=S(t),Df).getImmediate({identifier:e}),r=c("storage");r&&function(t,e,n,r={}){!function(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:d(i,t.app.options.projectId))}(t,e,n,r)}(n,...r)}(Lf),document.addEventListener("DOMContentLoaded",qf(Hf().mark((function t(){var e;return Hf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,jf();case 2:e=new Event("loadingIsFinished"),document.dispatchEvent(e);case 4:case"end":return t.stop()}}),t)}))))}();